/**
 * orb v1.0.8, Pivot grid javascript library.
 *
 * Copyright (c) 2014-2015 Najmeddine Nouri <devnajm@gmail.com>.
 *
 * @version v1.0.8
 * @link http://nnajm.github.io/orb/
 * @license MIT
 */

"use strict";!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.orb=e()}}(function(){return function e(t,n,a){function r(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return r(n?n:e)},c,c.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}({1:[function(e,t){t.exports.utils=e("./orb.utils"),t.exports.pgrid=e("./orb.pgrid"),t.exports.pgridwidget=e("./orb.ui.pgridwidget"),t.exports.query=e("./orb.query")},{"./orb.pgrid":7,"./orb.query":8,"./orb.ui.pgridwidget":13,"./orb.utils":15}],2:[function(e,t){function n(e,t,n,r){var o=0,i=0,s=("all"===t?n:t).length;return s>0&&(r||s>1?(a(e,t,n,function(e){i+=e}),i/=s,a(e,t,n,function(e){o+=(e-i)*(e-i)}),o/=r?s:s-1):o=0/0),o}function a(e,t,n,a){var r="all"===t;if(t=r?n:t,t.length>0)for(var o=0;o<t.length;o++)a((r?t[o]:n[t[o]])[e])}var r=t.exports={toAggregateFunc:function(e){return e?"string"==typeof e&&r[e]?r[e]:"function"==typeof e?e:r.sum:r.sum},count:function(e,t,n){return"all"===t?n.length:t.length},sum:function(e,t,n){var r=0;return a(e,t,n,function(e){r+=e}),r},min:function(e,t,n){var r=null;return a(e,t,n,function(e){(null==r||r>e)&&(r=e)}),r},max:function(e,t,n){var r=null;return a(e,t,n,function(e){(null==r||e>r)&&(r=e)}),r},avg:function(e,t,n){var r=0,o=("all"===t?n:t).length;return o>0&&(a(e,t,n,function(e){r+=e}),r/=o),r},prod:function(e,t,n){var r,o=("all"===t?n:t).length;return o>0&&(r=1,a(e,t,n,function(e){r*=e})),r},stdev:function(e,t,a){return Math.sqrt(n(e,t,a,!1))},stdevp:function(e,t,a){return Math.sqrt(n(e,t,a,!0))},"var":function(e,t,a){return n(e,t,a,!1)},varp:function(e,t,a){return n(e,t,a,!0)}}},{}],3:[function(e,t){var n=e("./orb.utils"),a=e("./orb.dimension"),r={COLUMNS:1,ROWS:2,DATA:3};t.exports=function(e,t){function o(e){for(var t=0;t<s.fields.length;t++)if(s.fields[t].name===e.name)return t;return-1}function i(){if(null!=s.pgrid.filteredDataSource&&s.dimensionsCount>0){var e=s.pgrid.filteredDataSource;if(null!=e&&n.isArray(e)&&e.length>0)for(var t=0,r=e.length;r>t;t++)for(var o=e[t],i=s.root,u=0;u<s.dimensionsCount;u++){var c=s.dimensionsCount-u,d=s.fields[u],p=o[d.name],h=i.subdimvals;void 0!==h[p]?i=h[p]:(i.values.push(p),i=new a(++l,i,p,d,c,!1,u==s.dimensionsCount-1),h[p]=i,i.rowIndexes=[],s.dimensionsByDepth[c].push(i)),i.rowIndexes.push(t)}}}var s=this,l=0;null!=e&&null!=e.config&&(this.pgrid=e,this.type=t,this.fields=function(){switch(t){case r.COLUMNS:return s.pgrid.config.columnFields;case r.ROWS:return s.pgrid.config.rowFields;case r.DATA:return s.pgrid.config.dataFields;default:return[]}}(),this.dimensionsCount=null,this.root=null,this.dimensionsByDepth=null,this.update=function(){s.dimensionsCount=s.fields.length,s.root=new a(++l,null,null,null,s.dimensionsCount+1,!0),s.dimensionsByDepth={};for(var e=1;e<=s.dimensionsCount;e++)s.dimensionsByDepth[e]=[];i();for(var t=0;t<s.fields.length;t++){var n=s.fields[t];("asc"===n.sort.order||"desc"===n.sort.order)&&s.sort(n,!0)}},this.sort=function(e,t){if(null!=e){t!==!0&&(e.sort.order="asc"!==e.sort.order?"asc":"desc");for(var n=s.dimensionsCount-o(e),a=n===s.dimensionsCount?[s.root]:s.dimensionsByDepth[n+1],r=0;r<a.length;r++)a[r].values.sort(),"desc"===e.sort.order&&a[r].values.reverse()}})},t.exports.Type=r},{"./orb.dimension":5,"./orb.utils":15}],4:[function(e,t){function n(e,t,n){for(var a=0;a<t.length;a++)if(null!=t[a][e])return t[a][e];return n}function a(){for(var e=[],t=[],a=[],r=[],o=0;o<arguments.length;o++){var i=arguments[o]||{};e.push(i),t.push(i.sort||{}),a.push(i.subTotal||{}),r.push({aggregateFuncName:i.aggregateFuncName,aggregateFunc:0===o?i.aggregateFunc:i.aggregateFunc?i.aggregateFunc():null,formatFunc:0===o?i.formatFunc:i.formatFunc?i.formatFunc():null})}return new h({name:n("name",e,""),caption:n("caption",e,""),sort:{order:n("order",t,null),customfunc:n("customfunc",t,null)},subTotal:{visible:n("visible",a,!0),collapsible:n("collapsible",a,!0),collapsed:n("collapsed",a,!1)},aggregateFuncName:n("aggregateFuncName",r,"sum"),aggregateFunc:n("aggregateFunc",r,null),formatFunc:n("formatFunc",r,null)},!1)}function r(e,t,n,r){var o;if(r)switch(t){case u.Type.ROWS:o=r.rowSettings;break;case u.Type.COLUMNS:o=r.columnSettings;break;case u.Type.DATA:o=r.dataSettings;break;default:o=null}else o=null;return a(n,o,r,e)}function o(e){e=e||{},this.rowsvisible=void 0!==e.rowsvisible?e.rowsvisible:!0,this.columnsvisible=void 0!==e.columnsvisible?e.columnsvisible:!0}function i(e,t){var n={visible:t===!0?!0:void 0,collapsible:t===!0?!0:void 0,collapsed:t===!0?!1:void 0};e=e||{},this.visible=void 0!==e.visible?e.visible:n.visible,this.collapsible=void 0!==e.collapsible?e.collapsible:n.collapsible,this.collapsed=void 0!==e.collapsed?e.collapsed:n.collapsed}function s(e){e=e||{},this.order=e.order,this.customfunc=e.customfunc}var l=e("./orb.utils"),u=e("./orb.axe"),c=e("./orb.aggregation"),d=e("./orb.filtering"),p=e("./orb.themes"),h=t.exports.field=function(e,t){function n(e){return e?e.toString():""}e=e||{},this.name=e.name,this.caption=e.caption||this.name,this.sort=new s(e.sort),this.subTotal=new i(e.subTotal);var a,r;this.aggregateFunc=function(e){return e?void(a=c.toAggregateFunc(e)):a},this.formatFunc=function(e){return e?void(r=e):r},this.aggregateFuncName=e.aggregateFuncName||(e.aggregateFunc&&l.isString(e.aggregateFunc)?e.aggregateFunc:null),this.aggregateFunc(e.aggregateFunc||"sum"),this.formatFunc(e.formatFunc||n),t!==!1&&((this.rowSettings=new h(e.rowSettings,!1)).name=this.name,(this.columnSettings=new h(e.columnSettings,!1)).name=this.name,(this.dataSettings=new h(e.dataSettings,!1)).name=this.name)};t.exports.config=function(e){function t(e){return"string"==typeof e?{name:s.captionToName(e)}:e}function n(e,t){var n=a(e,t);return n>-1?e[n]:null}function a(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}var s=this;this.dataSource=e.dataSource||[],this.dataHeadersLocation="columns"===e.dataHeadersLocation?"columns":"rows",this.grandTotal=new o(e.grandTotal),this.subTotal=new i(e.subTotal,!0),this.width=e.width,this.height=e.height,this.showToolbar=e.showToolbar||!1,this.theme=p,p.current(e.theme),this.dataSourceFieldNames=[],this.dataSourceFieldCaptions=[],this.captionToName=function(e){var t=s.dataSourceFieldCaptions.indexOf(e);return t>=0?s.dataSourceFieldNames[t]:e},this.nameToCaption=function(e){var t=s.dataSourceFieldNames.indexOf(e);return t>=0?s.dataSourceFieldCaptions[t]:e},this.setTheme=function(e){return s.theme.current()!==s.theme.current(e)},this.allFields=(e.fields||[]).map(function(e){var t=new h(e);return s.dataSourceFieldNames.push(t.name),s.dataSourceFieldCaptions.push(t.caption),t}),this.rowFields=(e.rows||[]).map(function(e){return e=t(e),r(s,u.Type.ROWS,e,n(s.allFields,e.name))}),this.columnFields=(e.columns||[]).map(function(e){return e=t(e),r(s,u.Type.COLUMNS,e,n(s.allFields,e.name))}),this.dataFields=(e.data||[]).map(function(e){return e=t(e),r(s,u.Type.DATA,e,n(s.allFields,e.name))}),this.dataFieldsCount=this.dataFields?this.dataFields.length||1:1,this.getField=function(e){return n(s.allFields,e)},this.getRowField=function(e){return n(s.rowFields,e)},this.getColumnField=function(e){return n(s.columnFields,e)},this.getDataField=function(e){return n(s.dataFields,e)},this.availablefields=function(){return s.allFields.filter(function(e){var t=function(t){return e.name!==t.name};return s.dataFields.every(t)&&s.rowFields.every(t)&&s.columnFields.every(t)})},this.getDataSourceFieldCaptions=function(){var e;if(s.dataSource&&(e=s.dataSource[0])){for(var t=l.ownProperties(e),n=[],a=0;a<t.length;a++)n.push(s.nameToCaption(t[a]));return n}return null},this.getPreFilters=function(){var t={};return e.preFilters&&l.ownProperties(e.preFilters).forEach(function(n){var a=e.preFilters[n];if(l.isArray(a))t[s.captionToName(n)]=new d.expressionFilter(null,null,a,!1);else{var r=l.ownProperties(a)[0];r&&(t[s.captionToName(n)]=new d.expressionFilter(r,a[r]))}}),t},this.moveField=function(e,t,o,i){var l,c,d,p=n(s.allFields,e);if(p){switch(t){case u.Type.ROWS:l=s.rowFields;break;case u.Type.COLUMNS:l=s.columnFields;break;case u.Type.DATA:l=s.dataFields}switch(o){case u.Type.ROWS:d=s.rowFields;break;case u.Type.COLUMNS:d=s.columnFields;break;case u.Type.DATA:d=s.dataFields}if(l||d){if(l){if(c=a(l,e),t===o&&(c==l.length-1&&null==i||c===i-1))return!1;l.splice(c,1)}return p=r(s,o,null,p),d&&(null!=i?d.splice(i,0,p):d.push(p)),s.dataFieldsCount=s.dataFields?s.dataFields.length||1:1,!0}}}}},{"./orb.aggregation":2,"./orb.axe":3,"./orb.filtering":6,"./orb.themes":10,"./orb.utils":15}],5:[function(e,t){t.exports=function(e,t,n,a,r,o,i){var s=this;this.id=e,this.parent=t,this.value=n,this.isRoot=o,this.isLeaf=i,this.field=a,this.depth=r,this.values=[],this.subdimvals={},this.rowIndexes=null,this.getRowIndexes=function(e){if(null==s.rowIndexes){s.rowIndexes=[];for(var t=0;t<s.values.length;t++)s.subdimvals[s.values[t]].getRowIndexes(s.rowIndexes)}if(null!=e){for(var n=0;n<s.rowIndexes.length;n++)e.push(s.rowIndexes[n]);return e}return s.rowIndexes}}},{}],6:[function(e,t){var n=e("./orb.utils"),a=t.exports={ALL:"#All#",NONE:"#None#",BLANK:'#Blank#"'};a.expressionFilter=function(e,t,o,i){var s=this;this.operator=r.get(e),this.regexpMode=!1,this.term=t||null,this.term&&this.operator&&this.operator.regexpSupported&&n.isRegExp(this.term)&&(this.regexpMode=!0,this.term.ignoreCase||(this.term=new RegExp(this.term.source,"i"))),this.staticValue=o,this.excludeStatic=i,this.test=function(e){if(n.isArray(s.staticValue)){var t=s.staticValue.indexOf(e)>=0;return s.excludeStatic&&!t||!s.excludeStatic&&t}return s.term?s.operator.func(e,s.term):s.staticValue===!0||s.staticValue===a.ALL?!0:s.staticValue===!1||s.staticValue===a.NONE?!1:!0},this.isAlwaysTrue=function(){return!(s.term||n.isArray(s.staticValue)||s.staticValue===a.NONE||s.staticValue===!1)}};var r=a.Operators={get:function(e){switch(e){case r.MATCH.name:return r.MATCH;case r.NOTMATCH.name:return r.NOTMATCH;case r.EQ.name:return r.EQ;case r.NEQ.name:return r.NEQ;case r.GT.name:return r.GT;case r.GTE.name:return r.GTE;case r.LT.name:return r.LT;case r.LTE.name:return r.LTE;default:return r.NONE}},NONE:null,MATCH:{name:"Matches",func:function(e,t){return e?e.toString().search(n.isRegExp(t)?t:new RegExp(t,"i"))>=0:!t},regexpSupported:!0},NOTMATCH:{name:"Does Not Match",func:function(e,t){return e?e.toString().search(n.isRegExp(t)?t:new RegExp(t,"i"))<0:!!t},regexpSupported:!0},EQ:{name:"=",func:function(e,t){return e==t},regexpSupported:!1},NEQ:{name:"<>",func:function(e,t){return e!=t},regexpSupported:!1},GT:{name:">",func:function(e,t){return e>t},regexpSupported:!1},GTE:{name:">=",func:function(e,t){return e>=t},regexpSupported:!1},LT:{name:"<",func:function(e,t){return t>e},regexpSupported:!1},LTE:{name:"<=",func:function(e,t){return t>=e},regexpSupported:!1}}},{"./orb.utils":15}],7:[function(e,t){var n=e("./orb.axe"),a=e("./orb.config").config,r=e("./orb.filtering"),o=e("./orb.query"),i=e("./orb.utils");t.exports=function(e){function t(e){e!==!1&&s(),h.rows.update(),h.columns.update(),c()}function s(){var e=i.ownProperties(h.filters);if(e.length>0){h.filteredDataSource=[];for(var t=0;t<h.config.dataSource.length;t++){for(var n=h.config.dataSource[t],a=!1,r=0;r<e.length;r++){var o=e[r],s=h.filters[o];if(s&&!s.test(n[o])){a=!0;break}}a||h.filteredDataSource.push(n)}}else h.filteredDataSource=h.config.dataSource}function l(e,t,n,a,r){var o={};if(h.config.dataFieldsCount>0){var i;if(null==e)i=t;else if(null==t)i=e;else{i=[];for(var s=0;s<e.length;s++){var l=e[s];if(l>=0){var u=t.indexOf(l);u>=0&&(e[s]=0-(l+2),i.push(l))}}}var c,d=(h.filteredDataSource,[]);if(a)for(var f=0;f<a.length;f++)c=h.config.getDataField(a[f]),r||(c?r=c.aggregateFunc():(c=h.config.getField(a[f]),c&&(r=c.dataSettings?c.dataSettings.aggregateFunc():c.aggregateFunc()))),c&&r&&d.push({field:c,aggregateFunc:r});else for(var g=0;g<h.config.dataFieldsCount;g++)c=h.config.dataFields[g]||p,(r||c.aggregateFunc)&&d.push({field:c,aggregateFunc:r||c.aggregateFunc()});for(var m=0;m<d.length;m++)c=d[m],o[c.field.name]=c.aggregateFunc(c.field.name,i||"all",h.filteredDataSource,n||e,t)}return o}function u(e){if(e){var t={},n="r"+e.id;if(void 0===d[n]&&(d[n]=e.isRoot?null:d[e.parent.id]||e.getRowIndexes()),t[h.columns.root.id]=l(e.isRoot?null:d[n].slice(0),null),h.columns.dimensionsCount>0)for(var a=0,r=[h.columns.root];a<r.length;){for(var o=r[a],i=e.isRoot?null:o.isRoot?d[n].slice(0):d["c"+o.id].slice(0),s=0;s<o.values.length;s++){var u=o.subdimvals[o.values[s]],c="c"+u.id;if(void 0===d[c]&&(d[c]=d[c]||u.getRowIndexes().slice(0)),t[u.id]=l(i,d[c],e.isRoot?null:e.getRowIndexes()),!u.isLeaf&&(r.push(u),i)){d[c]=[];for(var p=0;p<i.length;p++){var f=i[p];-1!=f&&0>f&&(d[c].push(0-(f+2)),i[p]=-1)}}}d["c"+o.id]=void 0,a++}return t}}function c(){if(h.dataMatrix={},d={},h.dataMatrix[h.rows.root.id]=u(h.rows.root),h.rows.dimensionsCount>0)for(var e,t=[h.rows.root],n=0;n<t.length;){e=t[n];for(var a=0;a<e.values.length;a++){var r=e.subdimvals[e.values[a]];h.dataMatrix[r.id]=u(r),r.isLeaf||t.push(r)}n++}}var d,p={name:"#undefined#"},h=this;this.config=new a(e),this.filters=h.config.getPreFilters(),this.filteredDataSource=h.config.dataSource,this.rows=new n(h,n.Type.ROWS),this.columns=new n(h,n.Type.COLUMNS),this.dataMatrix={},this.moveField=function(e,n,a,r){h.config.moveField(e,n,a,r)&&t(!1)},this.applyFilter=function(e,n,a,o,i){h.filters[e]=new r.expressionFilter(n,a,o,i),t()},this.refreshData=function(e){h.config.dataSource=e,t()},this.getFieldValues=function(e,t){for(var n=[],a=[],r=!1,o=0;o<h.config.dataSource.length;o++){var s=h.config.dataSource[o],l=s[e];void 0!==t?(t===!0||"function"==typeof t&&t(l))&&n.push(l):l?n.push(l):r=!0}if(n.length>1){i.isNumber(n[0])||i.isDate(n[0])?n.sort(function(e,t){return e?t?e-t:1:t?-1:0}):n.sort();for(var u=0;u<n.length;u++)(0===u||n[u]!==a[a.length-1])&&a.push(n[u])}else a=n;return a.containsBlank=r,a},this.getFieldFilter=function(e){return h.filters[e]},this.isFieldFiltered=function(e){var t=h.getFieldFilter(e);return null!=t&&!t.isAlwaysTrue()},this.getData=function(e,t,n,a){if(t&&n){var r=e||(h.config.dataFields[0]||p).name,o=h.config.getDataField(r);return!o||a&&o.aggregateFunc!=a?h.calcAggregation(t.isRoot?null:t.getRowIndexes().slice(0),n.isRoot?null:n.getRowIndexes().slice(0),[r],a)[r]||null:h.dataMatrix[t.id]&&h.dataMatrix[t.id][n.id]?h.dataMatrix[t.id][n.id][r]||null:null}},this.calcAggregation=function(e,t,n,a){return l(e,t,e,n,a)},this.query=o(h),t()}},{"./orb.axe":3,"./orb.config":4,"./orb.filtering":6,"./orb.query":8,"./orb.utils":15}],8:[function(e,t){var n=e("./orb.utils"),a=e("./orb.axe"),r=e("./orb.aggregation"),o=function(e,t,a){var o=this;this.source=e,this.query=t,this.filters=a,this.extractResult=function(e,t,n){if(n.multi===!0){for(var a={},r=0;r<t.multiFieldNames.length;r++)a[t.multiFieldNames[r]]=e[o.getCaptionName(t.multiFieldNames[r])];return a}return e[n.datafieldname]},this.measureFunc=function(e,t,n,a){var r={datafieldname:o.getCaptionName(e),multi:t,aggregateFunc:n};return function(e){e=o.cleanOptions(e,arguments,r);var n=o.compute(e,a,t);return o.extractResult(n,e,r)}},this.setDefaultAggFunctions=function(e){var t=o.query.val?"val_":"val";o.query[t]=o.measureFunc(void 0,!0,void 0,e);for(var a=n.ownProperties(r),i=0;i<a.length;i++){var s=a[i];"toAggregateFunc"!==s&&(o.query[s]=o.measureFunc(void 0,!0,r[s],e))}}},i=function(e){function t(e,t){return function(n){return n.value===t.val&&(!e||e.some(function(e){var t=n.parent;if(t)for(;t.depth<e.depth;)t=t.parent;return t===e}))}}o.call(this,e,{},{});var n=this;this.getCaptionName=function(e){return n.source.config.captionToName(e)},this.cleanOptions=function(e,t,a){var o={fieldNames:[]};if(a.multi===!0){e&&"object"==typeof e?(o.aggregateFunc=e.aggregateFunc,o.multiFieldNames=e.fields):(o.aggregateFunc=a.aggregateFunc,o.multiFieldNames=t);for(var i=0;i<o.multiFieldNames.length;i++)o.fieldNames.push(n.getCaptionName(o.multiFieldNames[i]))}else o.aggregateFunc=e,o.fieldNames.push(a.datafieldname);return o.aggregateFunc&&(o.aggregateFunc=r.toAggregateFunc(o.aggregateFunc)),o},this.setup=function(e){var t,r=n.source.config.rowFields,o=n.source.config.columnFields,i=n.source.config.dataFields;for(t=0;t<r.length;t++)n.slice(r[t],a.Type.ROWS,r.length-t);for(t=0;t<o.length;t++)n.slice(o[t],a.Type.COLUMNS,o.length-t);for(t=0;t<i.length;t++){var s=i[t],l=s.name,u=s.caption||l;n.query[l]=n.query[u]=n.measureFunc(l)}if(e)for(var c in e)e.hasOwnProperty(c)&&n.query[c](e[c]);return n.setDefaultAggFunctions(),n.query},this.slice=function(e,t,a){n.query[e.name]=n.query[e.caption||e.name]=function(r){var o={name:e.name,val:r,depth:a};return(n.filters[t]=n.filters[t]||[]).push(o),n.query}},this.applyFilters=function(e){if(n.filters[e]){for(var r=n.filters[e].sort(function(e,t){return t.depth-e.depth}),o=n.source[e===a.Type.ROWS?"rows":"columns"],i=0,s=null;i<r.length;){var l=r[i];s=o.dimensionsByDepth[l.depth].filter(t(s,l)),i++}return s}return null},this.compute=function(e){var t,r=n.applyFilters(a.Type.ROWS)||[n.source.rows.root],o=n.applyFilters(a.Type.COLUMNS)||[n.source.columns.root];if(1===r.length&&1===o.length){t={};for(var i=0;i<e.fieldNames.length;i++)t[e.fieldNames[i]]=n.source.getData(e.fieldNames[i],r[0],o[0],e.aggregateFunc)}else{for(var s=[],l=[],u=0;u<r.length;u++)s=s.concat(r[u].getRowIndexes());for(var c=0;c<o.length;c++)l=l.concat(o[c].getRowIndexes());t=n.source.calcAggregation(s,l,e.fieldNames,e.aggregateFunc)}return t}},s=function(e){o.call(this,e,{},[]);var t=this,a={};this.setCaptionName=function(e,t){a[e||t]=t},this.getCaptionName=function(e){return a[e]||e},this.cleanOptions=function(e,n,a){var r={fieldNames:[]};if(a.multi===!0){e&&"object"==typeof e?(r.aggregateFunc=e.aggregateFunc,r.multiFieldNames=e.fields):(r.aggregateFunc=a.aggregateFunc,r.multiFieldNames=n);for(var o=0;o<r.multiFieldNames.length;o++)r.fieldNames.push(t.getCaptionName(r.multiFieldNames[o]))}else r.aggregateFunc=e||a.aggregateFunc,r.fieldNames.push(a.datafieldname);return r},this.setup=function(e){if(t.query.slice=function(e,n){var a={name:e,val:n};return t.filters.push(a),t.query},e)for(var a=n.ownProperties(e),r=0;r<a.length;r++){var o=a[r],i=e[o],s=i.caption||i.name;i.name=o,t.setCaptionName(s,o),i.toAggregate?t.query[o]=t.query[s]=t.measureFunc(o,!1,i.aggregateFunc):t.slice(i)}return t.setDefaultAggFunctions(e),t.query},this.slice=function(e){t.query[e.name]=t.query[e.caption||e.name]=function(n){return t.query.slice(e.name,n)}},this.applyFilters=function(){for(var e=[],n=0;n<t.source.length;n++){for(var a=t.source[n],r=!0,o=0;o<t.filters.length;o++){var i=t.filters[o];if(a[i.name]!==i.val){r=!1;break}}r&&e.push(n)}return e},this.compute=function(e,n,a){for(var o=t.applyFilters(),i={},s=0;s<e.fieldNames.length;s++){var l=e.fieldNames[s],u=r.toAggregateFunc(a===!0?e.aggregateFunc||(n&&n[l]?n[l].aggregateFunc:void 0):e.aggregateFunc);i[l]=u(l,o||"all",t.source,o,null)}return i}};t.exports=function(e,t){return n.isArray(e)?new s(e).setup(t):function(t){return new i(e).setup(t)}}},{"./orb.aggregation":2,"./orb.axe":3,"./orb.utils":15}],9:[function(e,t){t.exports=function(){var e={};this.set=function(t,n){e[t]=n},this.get=function(t){return e[t]}}},{}],10:[function(e,t){t.exports=function(){function e(){return"bootstrap"===t}var t="blue",n={};return n.themes={red:"#C72C48",blue:"#268BD2",green:"#3A9D23",orange:"#f7840d",flower:"#A74AC7",gray:"#808080",white:"#FFFFFF",black:"#000000"},n.current=function(e){return e&&(t=n.validateTheme(e)),t},n.validateTheme=function(e){return e=(e||"").toString().trim(),n.themes[e]||"bootstrap"===e?e:"blue"},n.getPivotClasses=function(){return{container:"orb-container orb-"+t,table:"orb"+(e()?" table":"")}},n.getButtonClasses=function(){return{pivotButton:"fld-btn"+(e()?" btn btn-default":""),orbButton:"orb-btn"+(e()?" btn btn-default btn-xs":"")}},n.getFilterClasses=function(){return{container:"orb-"+t+" orb fltr-cntnr"}},n.getGridClasses=function(){return{table:e()?"table table-striped table-condensed":"orb-table"}},n.getDialogClasses=function(n){var a={overlay:"orb-overlay orb-overlay-"+(n?"visible":"hidden")+" orb-"+t,dialog:"orb-dialog",content:"",header:"orb-dialog-header",title:"",body:"orb-dialog-body"};return e()&&(a.overlay+=" modal",a.dialog+=" modal-dialog",a.content="modal-content",a.header+=" modal-header",a.title="modal-title",a.body+=" modal-body"),a},n}()},{}],11:[function(e,t){var n=e("./orb.axe"),a=e("./orb.ui.header");t.exports=function(e){function t(){function e(e){e&&e.dim.field.subTotal.visible&&t.push(e.subtotalHeader)}var t=[];if(o.headers.length>0){for(var n,r=o.headers[o.headers.length-1],l=r[0],u=l.parent,c=0;c<r.length;c++){if(l=r[c],n=l.parent,n!=u){if(e(u),null!=n)for(var d=n.parent,p=u?u.parent:null;d!=p&&null!=p;)e(p),d=d?d.parent:null,p=p?p.parent:null;u=n}if(t.push(r[c]),c===r.length-1)for(;null!=u;)e(u),u=u.parent}o.axe.pgrid.config.grandTotal.columnsvisible&&o.axe.dimensionsCount>1&&t.push(o.headers[0][o.headers[0].length-1])}if(i){o.leafsHeaders=[];for(var h=0;h<t.length;h++)for(var f=0;s>f;f++)o.leafsHeaders.push(new a.dataHeader(o.axe.pgrid.config.dataFields[f],t[h]));o.headers.push(o.leafsHeaders)}else o.leafsHeaders=t}function r(e,t){for(var r=t[t.length-1],i=o.axe.root.depth===e?[null]:t[o.axe.root.depth-e-1].filter(function(e){return e.type!==a.HeaderType.SUB_TOTAL}),l=0;l<i.length;l++)for(var u=i[l],c=null==u?o.axe.root:u.dim,d=0;d<c.values.length;d++){var p,h=c.values[d],f=c.subdimvals[h];p=!f.isLeaf&&f.field.subTotal.visible?new a.header(n.Type.COLUMNS,a.HeaderType.SUB_TOTAL,f,u,s):null;var g=new a.header(n.Type.COLUMNS,null,f,u,s,p);r.push(g),!f.isLeaf&&f.field.subTotal.visible&&r.push(p)}}var o=this;this.axe=e,this.headers=null,this.leafsHeaders=null;var i,s;this.build=function(){if(s="columns"===o.axe.pgrid.config.dataHeadersLocation?o.axe.pgrid.config.dataFieldsCount:1,i="columns"===o.axe.pgrid.config.dataHeadersLocation&&s>1,o.headers=[],null!=o.axe){for(var e=o.axe.root.depth;e>1;e--)o.headers.push([]),r(e,o.headers);o.axe.pgrid.config.grandTotal.columnsvisible&&(o.headers[0]=o.headers[0]||[]).push(new a.header(n.Type.COLUMNS,a.HeaderType.GRAND_TOTAL,o.axe.root,null,s)),0===o.headers.length&&o.headers.push([new a.header(n.Type.COLUMNS,a.HeaderType.INNER,o.axe.root,null,s)]),t()}},this.build()}},{"./orb.axe":3,"./orb.ui.header":12}],12:[function(e,t){function n(e){this.axetype=e.axetype,this.type=e.type,this.template=e.template,this.value=e.value,this.expanded=!0,this.cssclass=e.cssclass,this.hspan=e.hspan||function(){return 1},this.vspan=e.vspan||function(){return 1},this.visible=e.isvisible||function(){return!0},this.key=this.axetype+this.type+this.value,this.getState=function(){return r.get(this.key)},this.setState=function(e){r.set(this.key,e)}}var a=e("./orb.axe"),r=new(e("./orb.state")),o=t.exports.HeaderType={EMPTY:1,DATA_HEADER:2,DATA_VALUE:3,FIELD_BUTTON:4,INNER:5,WRAPPER:6,SUB_TOTAL:7,GRAND_TOTAL:8,getHeaderClass:function(e,t){var n=t===a.Type.ROWS?"header-row":t===a.Type.COLUMNS?"header-col":"";switch(e){case o.EMPTY:case o.FIELD_BUTTON:n="empty";break;case o.INNER:n="header "+n;break;case o.WRAPPER:n="header "+n;break;case o.SUB_TOTAL:n="header header-st "+n;break;case o.GRAND_TOTAL:n="header header-gt "+n}return n},getCellClass:function(e,t){var n="";switch(e){case o.GRAND_TOTAL:n="cell-gt";break;case o.SUB_TOTAL:n=t===o.GRAND_TOTAL?"cell-gt":"cell-st";break;default:n=t===o.GRAND_TOTAL?"cell-gt":t===o.SUB_TOTAL?"cell-st":"cell"}return n}};t.exports.header=function(e,t,r,i,s,l){function u(){if(f.type===o.SUB_TOTAL){for(var e=f.parent;null!=e;){if(e.subtotalHeader&&!e.subtotalHeader.expanded)return!1;e=e.parent}return!0}var t=f.dim.isRoot||f.dim.isLeaf||!f.dim.field.subTotal.visible||f.subtotalHeader.expanded;if(!t)return!1;for(var n=f.parent;null!=n&&(!n.dim.field.subTotal.visible||null!=n.subtotalHeader&&n.subtotalHeader.expanded);)n=n.parent;return null==n||null==n.subtotalHeader?t:n.subtotalHeader.expanded}function c(){var e,t=0,n=!1;if(f.visible()){if(f.dim.isLeaf)return s;for(var a=0;a<f.subheaders.length;a++){var r=f.subheaders[a];r.dim.isLeaf?t+=s:(e=g?r.vspan():r.hspan(),t+=e,0===a&&(0===e||g&&r.type===o.SUB_TOTAL&&!r.expanded)&&(n=!0))}return t+(n?1:0)}return t}var d,p,h,f=this,g=e===a.Type.ROWS;switch(t=t||(1===r.depth?o.INNER:o.WRAPPER)){case o.GRAND_TOTAL:h="Grand Total",d=g?r.depth-1||1:s,p=g?s:r.depth-1||1;break;case o.SUB_TOTAL:h="Total "+r.value,d=g?r.depth:s,p=g?s:r.depth;break;default:h=r.value,d=g?1:null,p=g?null:1}n.call(this,{axetype:e,type:t,template:g?"cell-template-row-header":"cell-template-column-header",value:h,cssclass:o.getHeaderClass(t,e),hspan:null!=d?function(){return d}:c,vspan:null!=p?function(){return p}:c,isvisible:u}),this.subtotalHeader=l,this.parent=i,this.subheaders=[],this.dim=r,this.expanded=this.getState()?this.getState().expanded:t!==o.SUB_TOTAL||!r.field.subTotal.collapsed,this.expand=function(){f.expanded=!0,this.setState({expanded:f.expanded})},this.collapse=function(){f.expanded=!1,this.setState({expanded:f.expanded})},null!=i&&i.subheaders.push(this)},t.exports.dataHeader=function(e,t){n.call(this,{axetype:null,type:o.DATA_HEADER,template:"cell-template-dataheader",value:e,cssclass:o.getHeaderClass(t.type,t.axetype),isvisible:t.visible}),this.parent=t},t.exports.dataCell=function(e,t,a,r){this.rowDimension=a.type===o.DATA_HEADER?a.parent.dim:a.dim,this.columnDimension=r.type===o.DATA_HEADER?r.parent.dim:r.dim,this.rowType=a.type===o.DATA_HEADER?a.parent.type:a.type,this.colType=r.type===o.DATA_HEADER?r.parent.type:r.type,this.datafield=e.config.dataFieldsCount>1?"rows"===e.config.dataHeadersLocation?a.value:r.value:e.config.dataFields[0],n.call(this,{axetype:null,type:o.DATA_VALUE,template:"cell-template-datavalue",value:e.getData(this.datafield?this.datafield.name:null,this.rowDimension,this.columnDimension),cssclass:"cell "+o.getCellClass(this.rowType,this.colType),isvisible:t})},t.exports.buttonCell=function(e){n.call(this,{axetype:null,type:o.FIELD_BUTTON,template:"cell-template-fieldbutton",value:e,cssclass:o.getHeaderClass(o.FIELD_BUTTON)})},t.exports.emptyCell=function(e,t){n.call(this,{axetype:null,type:o.EMPTY,template:"cell-template-empty",value:null,cssclass:o.getHeaderClass(o.EMPTY),hspan:function(){return e},vspan:function(){return t}})}},{"./orb.axe":3,"./orb.state":9}],13:[function(e,t){var n=e("./orb.axe"),a=e("./orb.pgrid"),r=e("./orb.ui.header"),o=e("./orb.ui.rows"),i=e("./orb.ui.cols"),s=e("./react/orb.react.compiled");t.exports=function(e){function t(){function e(e,t){return function(){return e()&&t()}}c.rows=new o(c.pgrid.rows),c.columns=new i(c.pgrid.columns);var t=c.rows.headers,n=c.columns.leafsHeaders;c.layout={rowHeaders:{width:(c.pgrid.rows.fields.length||1)+("rows"===c.pgrid.config.dataHeadersLocation&&c.pgrid.config.dataFieldsCount>1?1:0),height:t.length},columnHeaders:{width:c.columns.leafsHeaders.length,height:(c.pgrid.columns.fields.length||1)+("columns"===c.pgrid.config.dataHeadersLocation&&c.pgrid.config.dataFieldsCount>1?1:0)}},c.layout.pivotTable={width:c.layout.rowHeaders.width+c.layout.columnHeaders.width,height:c.layout.rowHeaders.height+c.layout.columnHeaders.height};for(var a,s=[],l=0;l<t.length;l++){var u=t[l],d=u[u.length-1];a=[];for(var p=0;p<n.length;p++){var h=n[p],f=e(d.visible,h.visible);a[p]=new r.dataCell(c.pgrid,f,d,h)}s.push(a)}c.dataRows=s}var l,u,c=this,d=s.Dialog.create();this.pgrid=new a(e),this.rows=null,this.columns=null,this.dataRows=[],this.layout={rowHeaders:{width:null,height:null},columnHeaders:{width:null,height:null},pivotTable:{width:null,height:null}},this.sort=function(e,a){if(e===n.Type.ROWS)c.pgrid.rows.sort(a);else{if(e!==n.Type.COLUMNS)return;c.pgrid.columns.sort(a)}t()},this.refreshData=function(e){c.pgrid.refreshData(e),t(),u.setProps({})},this.applyFilter=function(e,n,a,r,o){c.pgrid.applyFilter(e,n,a,r,o),t()},this.moveField=function(e,n,a,r){c.pgrid.moveField(e,n,a,r),t()},this.changeTheme=function(e){u.changeTheme(e)},this.render=function(e){if(l=e){var t=React.createFactory(s.PivotTable),n=t({pgridwidget:c});u=React.render(n,e)}},this.drilldown=function(e){if(e){var t,n=e.columnDimension.getRowIndexes(),a=e.rowDimension.getRowIndexes().filter(function(e){return n.indexOf(e)>=0}).map(function(e){return c.pgrid.filteredDataSource[e]});t=e.rowType===r.HeaderType.GRAND_TOTAL&&e.colType===r.HeaderType.GRAND_TOTAL?"Grand total":e.rowType===r.HeaderType.GRAND_TOTAL?e.columnDimension.value+"/Grand total ":e.colType===r.HeaderType.GRAND_TOTAL?e.rowDimension.value+"/Grand total ":e.rowDimension.value+"/"+e.columnDimension.value;var o=window.getComputedStyle(u.getDOMNode(),null);d.show({title:t,comp:{type:s.Grid,props:{headers:c.pgrid.config.getDataSourceFieldCaptions(),data:a,theme:c.pgrid.config.theme}},theme:c.pgrid.config.theme,style:{fontFamily:o.getPropertyValue("font-family"),fontSize:o.getPropertyValue("font-size")}})}},t()}},{"./orb.axe":3,"./orb.pgrid":7,"./orb.ui.cols":11,"./orb.ui.header":12,"./orb.ui.rows":14,"./react/orb.react.compiled":16}],14:[function(e,t){var n=e("./orb.axe"),a=e("./orb.ui.header");t.exports=function(e){function t(e,t){if(i)for(var n=e[e.length-1],r=0;s>r;r++)n.push(new a.dataHeader(o.axe.pgrid.config.dataFields[r],t)),s-1>r&&e.push(n=[])}function r(e,o){if(o.values.length>0)for(var i=e.length-1,l=e[i],u=l.length>0?l[l.length-1]:null,c=0;c<o.values.length;c++){var d,p=o.values[c],h=o.subdimvals[p];d=!h.isLeaf&&h.field.subTotal.visible?new a.header(n.Type.ROWS,a.HeaderType.SUB_TOTAL,h,u,s):null;var f=new a.header(n.Type.ROWS,null,h,u,s,d);c>0&&e.push(l=[]),l.push(f),h.isLeaf?t(e,f):(r(e,h),h.field.subTotal.visible&&(e.push([d]),t(e,d)))}}var o=this;this.axe=e,this.headers=[];var i,s;this.build=function(){s="rows"===o.axe.pgrid.config.dataHeadersLocation?o.axe.pgrid.config.dataFieldsCount||1:1,i="rows"===o.axe.pgrid.config.dataHeadersLocation&&s>1;var e=[[]];if(null!=o.axe){if(r(e,o.axe.root),o.axe.pgrid.config.grandTotal.rowsvisible){var l=e[e.length-1],u=new a.header(n.Type.ROWS,a.HeaderType.GRAND_TOTAL,o.axe.root,null,s);0===l.length?l.push(u):e.push([u]),t(e,u)}0===e[0].length&&e[0].push(new a.header(n.Type.ROWS,a.HeaderType.INNER,o.axe.root,null,s))}o.headers=e},this.build()}},{"./orb.axe":3,"./orb.ui.header":12}],15:[function(e,t){t.exports={ns:function(e,t){var n=e.split("."),a=0;for(t=t||window;a<n.length;)t[n[a]]=t[n[a]]||{},t=t[n[a]],a++;return t},ownProperties:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isNumber:function(e){return"[object Number]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},isString:function(e){return"[object String]"===Object.prototype.toString.apply(e)},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.apply(e)},escapeRegex:function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},findInArray:function(e,t){if(this.isArray(e)&&t)for(var n=0;n<e.length;n++){var a=e[n];if(t(a))return a}return void 0},jsonStringify:function(e,t){function n(e,n){return t&&t.indexOf(e)>-1?void 0:n}return JSON.stringify(e,n,2)}}},{}],16:[function(e,t){function n(e,t){if(e&&e.node){for(var n=e.node,a=[],r=t?n.rows.length-1:0,o=r;o<n.rows.length;o++)for(var i=n.rows[o],s=0;s<i.cells.length;s++){var l=i.cells[s].getBoundingClientRect(),u=l.right-l.left;a.length-1<s?a.push(u):u>a[s]&&(a[s]=u)}e.widthArray=a}}function a(e,t){if(e&&e.node){e.width=0;for(var n=e.node,a=t?n.rows.length-1:0,r=a;r<n.rows.length;r++)for(var o=n.rows[r],i=0;i<o.cells.length;i++)o.cells[i].style.width=e.widthArray[i]+"px",r===a&&(e.width+=e.widthArray[i]);
n.style.width=e.width+"px"}}function r(e){if(e){for(var t=0;t<e.rows.length;t++)for(var n=e.rows[t],a=0;a<n.cells.length;a++)n.cells[a].style.width="";e.style.width=""}}function o(e){var t=e.cell,n=t.cssclass,a=!t.visible(),r="cell-template-empty"===t.template;return a&&(n+=" cell-hidden"),(e.leftmostheader||e.leftmostdatavalue||e.leftmost&&!r)&&(n+=" cell-leftmost"),e.topmost&&t.axetype!==c.Type.ROWS&&!r&&(n+=" cell-topmost"),!e.rightmost||t.axetype===c.Type.ROWS||t.axetype===c.Type.COLUMNS&&t.type!==d.HeaderType.GRAND_TOTAL||(n+=" cell-rightmost"),("cell-template-column-header"===t.template||"cell-template-dataheader"===t.template)&&(n+=" cntr"),n}function i(e,t){function n(e,t){return null==t?"none"!=e.parentNode.parentNode.style.display:void(e.parentNode.parentNode.style.display=t?"":"none")}function a(){if(t){var e={values:t.staticValue,toExclude:t.excludeStatic};t.term?(d=!0,f=t.operator,l.toggleRegexpButtonVisibility(),t.regexpMode?(h=!0,l.toggleRegexpButtonState(),g=t.term.source):g=t.term,m.searchBox.value=g,l.applyFilterTerm(t.operator,t.term)):i=e,l.updateCheckboxes(e),l.updateAllCheckbox()}}function r(){l.toggleRegexpButtonVisibility(),m.filterContainer.addEventListener("click",l.valueChecked),m.searchBox.addEventListener("keyup",l.searchChanged),m.okButton.addEventListener("click",function(){var t=l.getCheckedValues();e.onFilter(f.name,f.regexpSupported&&d&&h?new RegExp(g,"i"):g,t.values,t.toExclude)}),m.cancelButton.addEventListener("click",function(){e.destroy()})}function o(e,t,n){var a=301,r=223,o={x:0,y:0},i=!1;this.resizeMouseDown=function(e){0===e.button&&(i=!0,document.body.style.cursor="se-resize",o.x=e.pageX,o.y=e.pageY,e.stopPropagation(),e.preventDefault())},this.resizeMouseUp=function(){return i=!1,document.body.style.cursor="auto",!0},this.resizeMouseMove=function(s){if(i){var l=n.getBoundingClientRect(),u=e.getBoundingClientRect(),c=t.getBoundingClientRect(),d=u.right-u.left,p=u.bottom-u.top,h={x:a>=d&&s.pageX<l.left?0:s.pageX-o.x,y:r>=p&&s.pageY<l.top?0:s.pageY-o.y},f=d+h.x,g=p+h.y;o.x=s.pageX,o.y=s.pageY,f>=a&&(e.style.width=f+"px"),g>=r&&(e.style.height=g+"px",t.style.height=c.bottom-c.top+h.y+"px"),s.stopPropagation(),s.preventDefault()}},n.addEventListener("mousedown",this.resizeMouseDown),document.addEventListener("mouseup",this.resizeMouseUp),document.addEventListener("mousemove",this.resizeMouseMove)}var i,s,l=this,c="indeterminate",d=!1,h=!1,f=p.Operators.MATCH,g="",m={filterContainer:null,checkboxes:{},searchBox:null,operatorBox:null,allCheckbox:null,addCheckbox:null,enableRegexButton:null,okButton:null,cancelButton:null,resizeGrip:null};this.init=function(e){m.filterContainer=e,m.checkboxes={},m.searchBox=m.filterContainer.rows[0].cells[2].children[0],m.operatorBox=m.filterContainer.rows[0].cells[0].children[0],m.okButton=m.filterContainer.rows[2].cells[0].children[0],m.cancelButton=m.filterContainer.rows[2].cells[0].children[1],m.resizeGrip=m.filterContainer.rows[2].cells[1].children[0];for(var t=m.filterContainer.rows[1].cells[0].children[0].rows,n=0;n<t.length;n++){var i=t[n].cells[0].children[0];m.checkboxes[i.value]=i}m.allCheckbox=m.checkboxes[p.ALL],m.addCheckbox=null,m.enableRegexButton=m.filterContainer.rows[0].cells[1],s=new o(m.filterContainer.parentNode,m.filterContainer.rows[1].cells[0].children[0],m.resizeGrip),a(),r()},this.onOperatorChanged=function(e){f.name!==e&&(f=p.Operators.get(e),l.toggleRegexpButtonVisibility(),l.searchChanged("operatorChanged"))},this.toggleRegexpButtonVisibility=function(){f.regexpSupported?(m.enableRegexButton.addEventListener("click",l.regexpActiveChanged),m.enableRegexButton.className=m.enableRegexButton.className.replace(/\s+srchtyp\-col\-hidden/,"")):(m.enableRegexButton.removeEventListener("click",l.regexpActiveChanged),m.enableRegexButton.className+=" srchtyp-col-hidden")},this.toggleRegexpButtonState=function(){m.enableRegexButton.className=m.enableRegexButton.className.replace("srchtyp-col-active",""),h&&(m.enableRegexButton.className+=" srchtyp-col-active")},this.regexpActiveChanged=function(){h=!h,l.toggleRegexpButtonState(),l.searchChanged("regexModeChanged")},this.valueChecked=function(e){var t=e.target;t&&t.type&&"checkbox"===t.type&&(t==m.allCheckbox?l.updateCheckboxes({values:m.allCheckbox.checked}):l.updateAllCheckbox())},this.applyFilterTerm=function(t,a){var r=a?!1:!0,o=t.regexpSupported&&d?h?a:u.escapeRegex(a):a;n(m.allCheckbox,r);for(var i=0;i<e.values.length;i++){var s=e.values[i],l=m.checkboxes[s],c=!d||t.func(s,o);n(l,c),l.checked=c}},this.searchChanged=function(e){var t=(m.searchBox.value||"").trim();if("operatorChanged"===e||"regexModeChanged"===e&&t||t!=g){g=t;var n=d;d=""!==t,d&&!n&&(i=l.getCheckedValues()),("operatorChanged"!==e||d)&&l.applyFilterTerm(f,t),!d&&n&&l.updateCheckboxes(i),l.updateAllCheckbox()}},this.getCheckedValues=function(){if(d||m.allCheckbox.indeterminate){var t,a,r,o,i=0,s=0;for(a=0;a<e.values.length;a++)r=e.values[a],o=m.checkboxes[r],n(o)&&(i++,o.checked&&s++);if(0==s)t=p.NONE;else if(s==i)t=p.ALL;else{t=[];var l=s>i/2+1;for(a=0;a<e.values.length;a++)r=e.values[a],o=m.checkboxes[r],n(o)&&(!l&&o.checked||l&&!o.checked)&&t.push(r)}return{values:t,toExclude:l}}return{values:m.allCheckbox.checked?p.ALL:p.NONE,toExclude:!1}},this.updateCheckboxes=function(t){for(var a=t?t.values:null,r=u.isArray(a)?null:null==a||a===p.ALL?!0:a===p.NONE?!1:!!a,o=0;o<e.values.length;o++){var i=e.values[o],s=m.checkboxes[i];if(n(s))if(null!=r)s.checked=r;else{var l=a.indexOf(i)>=0;s.checked=t.toExclude?!l:l}}},this.updateAllCheckbox=function(){if(!d){for(var t=null,n=0;n<e.values.length;n++){var a=m.checkboxes[e.values[n]];if(null==t)t=a.checked;else if(t!==a.checked){t=c;break}}t===c?(m.allCheckbox.indeterminate=!0,m.allCheckbox.checked=!1):(m.allCheckbox.indeterminate=!1,m.allCheckbox.checked=t)}}}function s(){var e=document.createElement("div");return e.className="orb-overlay orb-overlay-hidden",document.body.appendChild(e),e}var l="undefined"==typeof window?e("react"):window.React,u=e("../orb.utils"),c=e("../orb.axe"),d=e("../orb.ui.header"),p=e("../orb.filtering"),h=e("./orb.react.utils"),f=t.exports,g=1,m={};t.exports.PivotTable=l.createClass({id:g++,pgrid:null,pgridwidget:null,getInitialState:function(){return f.DragManager.init(this),m[this.id]=[],this.registerThemeChanged(this.updateClasses),this.pgridwidget=this.props.pgridwidget,this.pgrid=this.pgridwidget.pgrid,{}},sort:function(e,t){this.pgridwidget.sort(e,t),this.setProps({})},moveButton:function(e,t,n){this.pgridwidget.moveField(e.props.field.name,e.props.axetype,t,n),this.setProps({})},expandRow:function(e){e.expand(),this.setProps({})},collapseRow:function(e){e.subtotalHeader.collapse(),this.setProps({})},applyFilter:function(e,t,n,a,r){this.pgridwidget.applyFilter(e,t,n,a,r),this.setProps({})},registerThemeChanged:function(e){e&&m[this.id].push(e)},unregisterThemeChanged:function(e){var t;e&&(t=m[this.id].indexOf(e))>=0&&m[this.id].splice(t,1)},changeTheme:function(e){if(this.pgridwidget.pgrid.config.setTheme(e))for(var t=0;t<m[this.id].length;t++)m[this.id][t]()},updateClasses:function(){var e=this.getDOMNode(),t=this.pgridwidget.pgrid.config.theme.getPivotClasses();e.className=t.container,e.children[1].className=t.table},componentDidUpdate:function(){this.optimizeColumnsWidth()},componentDidMount:function(){this.optimizeColumnsWidth();var e=this.refs.dataCellsContainer.getDOMNode(),t=this.refs.colHeadersTable.getDOMNode(),n=this.refs.rowHeadersTable.getDOMNode();e.addEventListener("scroll",function(){t.style.marginLeft=-e.scrollLeft+"px",n.style.marginTop=-e.scrollTop+"px"})},optimizeColumnsWidth:function(){var e=this,t=e.refs.pivotWrapperTable.getDOMNode(),o=e.refs.column1.getDOMNode(),i=e.refs.column2.getDOMNode(),s=e.refs.column3.getDOMNode();t.style.tableLayout="auto",o.style.width="",i.style.width="",s.style.width="";var l=function(){var t={};return["pivotContainer","dataCellsContainer","dataCellsTable","upperbuttonsRow","columnbuttonsRow","colHeadersTable","rowHeadersTable","rowHeadersContainer","horizontalScrollBar"].forEach(function(n){t[n]={node:e.refs[n].getDOMNode()},t[n].size=h.getSize(t[n].node)}),t}();r(l.dataCellsTable.node),r(l.colHeadersTable.node),l.dataCellsContainer.node.style.width="",n(l.dataCellsTable),n(l.colHeadersTable,!0);for(var u=[],c=0;c<l.dataCellsTable.widthArray.length;c++){var d=l.dataCellsTable.widthArray[c],p=l.colHeadersTable.widthArray[c];u.push(p>d?p:d)}a(l.dataCellsTable),a(l.colHeadersTable,!0),l.dataCellsContainer.node.style.width=l.pivotContainer.size.width-l.rowHeadersTable.size.width-16+"px";var f=l.pivotContainer.size.height-l.upperbuttonsRow.size.height-l.columnbuttonsRow.size.height-l.colHeadersTable.size.height-l.horizontalScrollBar.size.height-3;l.dataCellsContainer.node.style.height=f+"px",l.rowHeadersContainer.node.style.height=f+"px",o.style.width=l.rowHeadersTable.size.width+"px",i.style.width=l.dataCellsContainer.node.style.width+"px",s.style.width="16px",t.style.tableLayout="fixed",this.refs.horizontalScrollBar.setScrollComps(l.dataCellsContainer.node,l.dataCellsTable.node,function(e){var t=e*(h.getSize(l.dataCellsTable.node).width-h.getSize(l.dataCellsContainer.node).width);l.colHeadersTable.node.style.marginLeft=-t+"px",l.dataCellsTable.node.style.marginLeft=-t+"px"})},render:function(){var e=this,t=this.pgridwidget.pgrid.config,n=f.Toolbar,a=f.PivotTableUpperButtons,r=f.PivotTableColumnButtons,o=f.PivotTableRowButtons,i=f.PivotTableRowHeaders,s=f.PivotTableColumnHeaders,l=f.PivotTableDataCells,u=f.HorizontalScrollBar,c=t.theme.getPivotClasses(),d={};return t.width&&(d.width=t.width),t.height&&(d.height=t.height),React.createElement("div",{className:c.container,style:d,ref:"pivotContainer"},React.createElement("div",{className:"orb-toolbar",style:{display:t.showToolbar?"block":"none"}},React.createElement(n,{pivotTableComp:e})),React.createElement("table",{id:"tbl-"+e.id,ref:"pivotWrapperTable",className:c.table,style:{width:"100%",tableLayout:"fixed"}},React.createElement("colgroup",null,React.createElement("col",{ref:"column1"}),React.createElement("col",{ref:"column2"}),React.createElement("col",{ref:"column3"})),React.createElement("tbody",null,React.createElement("tr",{ref:"upperbuttonsRow"},React.createElement("td",{colSpan:"3"},React.createElement(a,{pivotTableComp:e}))),React.createElement("tr",{ref:"columnbuttonsRow"},React.createElement("td",null),React.createElement("td",{colSpan:"2"},React.createElement(r,{pivotTableComp:e}))),React.createElement("tr",null,React.createElement("td",null,React.createElement(o,{pivotTableComp:e})),React.createElement("td",{style:{overflow:"hidden"}},React.createElement(s,{pivotTableComp:e,ref:"colHeadersTable"})),React.createElement("td",null)),React.createElement("tr",null,React.createElement("td",{className:"cell-topmost",style:{overflow:"hidden"}},React.createElement("div",{className:"inner-table-container",ref:"rowHeadersContainer"},React.createElement(i,{pivotTableComp:e,ref:"rowHeadersTable"}))),React.createElement("td",null,React.createElement("div",{className:"inner-table-container",ref:"dataCellsContainer"},React.createElement(l,{pivotTableComp:e,ref:"dataCellsTable"}))),React.createElement("td",null)),React.createElement("tr",null,React.createElement("td",null),React.createElement("td",null,React.createElement(u,{ref:"horizontalScrollBar"})),React.createElement("td",null)))),React.createElement("div",{className:"orb-overlay orb-overlay-hidden",id:"drilldialog"+e.id}))}}),t.exports.PivotRow=l.createClass({render:function(){var e,t=this,n=f.PivotCell,a=this.props.row.length-1,r=this.props.row[0],o={};return void 0!==this.props.rowButtonsCell?(e=this.props.row.slice(this.props.rowButtonsCount).map(function(e,r){var o=r===a-t.props.rowButtonsCount,i=0===r;return React.createElement(n,{key:r,cell:e,topmost:t.props.topmost,rightmost:o,leftmostheader:i,pivotTableComp:t.props.pivotTableComp})}),React.createElement("tr",null,this.props.rowButtonsCell,e)):("cell-template-row-header"==r.template&&r.visible&&!r.visible()&&(o.display="none"),e=this.props.row.map(function(e,r){var o=r===a,i=0===r&&(e.type===d.HeaderType.EMPTY||e.type===d.HeaderType.SUB_TOTAL&&e.dim.parent.isRoot||e.type===d.HeaderType.GRAND_TOTAL||e.dim&&(e.dim.isRoot||e.dim.parent.isRoot)),s="cell-template-column-header"===e.template&&1===r,l="cell-template-datavalue"===e.template&&(0===r&&e.visible()||r>0&&!t.props.row[r-1].visible());return React.createElement(n,{key:r,cell:e,topmost:t.props.topmost,leftmostheader:s,leftmostdatavalue:l,rightmost:o,leftmost:i,pivotTableComp:t.props.pivotTableComp})}),React.createElement("tr",{style:o},e))}}),t.exports.PivotCell=l.createClass({expand:function(){this.props.pivotTableComp.expandRow(this.props.cell)},collapse:function(){this.props.pivotTableComp.collapseRow(this.props.cell)},render:function(){var e,t,n=this,a=this.props.cell,r=[],i=!1;switch(a.template){case"cell-template-row-header":case"cell-template-column-header":var s=a.type===d.HeaderType.WRAPPER&&a.dim.field.subTotal.visible&&a.dim.field.subTotal.collapsible&&a.subtotalHeader.expanded,l=a.type===d.HeaderType.SUB_TOTAL&&!a.expanded;(s||l)&&(i=!0,r.push(React.createElement("table",{key:"header-value"},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"orb-tgl-btn"},React.createElement("div",{className:"orb-tgl-btn-"+(s?"down":"right"),onClick:s?this.collapse:this.expand})),React.createElement("td",{className:"hdr-val"},React.createElement("div",null,a.value))))))),e=a.value;break;case"cell-template-dataheader":e=a.value.caption;break;case"cell-template-datavalue":e=a.datafield&&a.datafield.formatFunc?a.datafield.formatFunc()(a.value):a.value,t=function(){n.props.pivotTableComp.pgridwidget.drilldown(a,n.props.pivotTableComp.id)}}return i||r.push(React.createElement("div",{key:"cell-value",className:"cell-template-datavalue"!==a.template?"hdr-val":""},React.createElement("div",null,e))),React.createElement("td",{className:o(this.props),onDoubleClick:t,colSpan:a.hspan(),rowSpan:a.vspan()},React.createElement("div",null,r))}});var v=t.exports.DragManager=function(){function e(e,t){return!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function t(e){return e.onDragOver?(e.onDragOver(i),!0):!1}function n(e){return e.onDragEnd?(e.onDragEnd(),!0):!1}function a(){return h.forEach(l,function(e){return e.component.state.isover?e:void 0},!0)}function r(){return h.forEach(u,function(e){return e.component.state.isover?e:void 0},!0)}var o=null,i=null,s=null,l=[],u=[],c=!1;return{init:function(e){c=!0,o=e},dragElement:function(e){var t=i;if(i=e,i!=t)if(null==e){var c=a(),d=r();if(c){var p=null!=d?d.position:null;o.moveButton(t,c.component.props.axetype,p)}s=null,h.forEach(l,function(e){n(e)}),h.forEach(u,function(e){n(e)})}else s=i.getDOMNode()},registerTarget:function(e,t,n,a){l.push({component:e,axetype:t,onDragOver:n,onDragEnd:a})},unregisterTarget:function(e){for(var t,n=0;n<l.length;n++)if(l[n].component==e){t=n;break}null!=t&&l.splice(t,1)},registerIndicator:function(e,t,n,a,r){u.push({component:e,axetype:t,position:n,onDragOver:a,onDragEnd:r})},unregisterIndicator:function(e){for(var t,n=0;n<u.length;n++)if(u[n].component==e){t=n;break}null!=t&&u.splice(t,1)},elementMoved:function(){if(null!=i){var a,r=s.getBoundingClientRect();h.forEach(l,function(o){if(!a){var i=o.component.getDOMNode().getBoundingClientRect(),s=e(r,i);if(s&&t(o))return a=o,!0;n(o)}},!0);var o;if(a){if(h.forEach(u,function(s){if(!o){var l=s.component.props.axetype===i.props.axetype&&s.component.props.position===i.props.position,u=s.component.props.axetype===a.component.props.axetype;if(u&&!l){var c=s.component.getDOMNode().getBoundingClientRect(),d=e(r,c);if(d&&t(s))return void(o=s)}}n(s)}),!o){var c=u.filter(function(e){return e.component.props.axetype===a.component.props.axetype});c.length>0&&t(c[c.length-1])}}else h.forEach(u,function(e){n(e)})}}}}();t.exports.DropIndicator=l.createClass({displayName:"DropIndicator",getInitialState:function(){return v.registerIndicator(this,this.props.axetype,this.props.position,this.onDragOver,this.onDragEnd),{isover:!1}},componentWillUnmount:function(){v.unregisterIndicator(this)},onDragOver:function(e){this.setState({isover:!0,width:e.getDOMNode().style.width})},onDragEnd:function(){this.setState({isover:!1,width:null})},render:function(){var e="drp-indic";this.props.isFirst&&(e+=" drp-indic-first"),this.props.isLast&&(e+=" drp-indic-last");var t={};return this.state.isover&&(e+=" drp-indic-over"),React.createElement("div",{style:t,className:e})}});var b=0;t.exports.DropTarget=l.createClass({getInitialState:function(){return this.dtid=++b,v.registerTarget(this,this.props.axetype,this.onDragOver,this.onDragEnd),{isover:!1}},componentWillUnmount:function(){v.unregisterTarget(this)},onDragOver:function(){this.setState({isover:!0})},onDragEnd:function(){this.setState({isover:!1})},render:function(){var e=this,n=t.exports.DropIndicator,a=this.props.buttons.map(function(t,a){return a<e.props.buttons.length-1?[React.createElement(n,{isFirst:0===a,position:a,axetype:e.props.axetype}),t]:[React.createElement(n,{isFirst:0===a,position:a,axetype:e.props.axetype}),t,React.createElement(n,{isLast:!0,position:null,axetype:e.props.axetype})]});return React.createElement("div",{className:"drp-trgt"+(this.state.isover?" drp-trgt-over":"")},a)}});var y=0;t.exports.PivotButton=l.createClass({displayName:"PivotButton",getInitialState:function(){return this.pbid=++y,{pos:{x:0,y:0},startpos:{x:0,y:0},mousedown:!1,dragging:!1}},onFilterMouseDown:function(e){if(0===e.button){var t=this.getDOMNode().childNodes[0].rows[0].cells[2].childNodes[0],n=h.getOffset(t),a=document.createElement("div"),r=React.createFactory(f.FilterPanel),o=r({field:this.props.field.name,pivotTableComp:this.props.pivotTableComp});a.className=this.props.pivotTableComp.pgrid.config.theme.getFilterClasses().container,a.style.top=n.y+"px",a.style.left=n.x+"px",document.body.appendChild(a),React.render(o,a),e.stopPropagation(),e.preventDefault()}},componentDidUpdate:function(){this.state.mousedown?this.state.mousedown&&(v.dragElement(this),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)):(v.dragElement(null),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},componentDidMount:function(){this.props.pivotTableComp.registerThemeChanged(this.updateClasses)},componentWillUnmount:function(){this.props.pivotTableComp.unregisterThemeChanged(this.updateClasses),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},onMouseDown:function(e){if(0===e.button){var t=h.getOffset(this.getDOMNode());this.setState({mousedown:!0,mouseoffset:{x:t.x-e.pageX,y:t.y-e.pageY},startpos:{x:e.pageX,y:e.pageY}}),e.stopPropagation(),e.preventDefault()}},onMouseUp:function(){var e=this.state.dragging;return this.setState({mousedown:!1,dragging:!1,size:null,pos:{x:0,y:0}}),e||this.props.pivotTableComp.sort(this.props.axetype,this.props.field),!0},onMouseMove:function(e){if(this.state.mousedown){var t=null;t=this.state.dragging?this.state.size:h.getSize(this.getDOMNode());var n={x:e.pageX+this.state.mouseoffset.x,y:e.pageY+this.state.mouseoffset.y};this.setState({dragging:!0,size:t,pos:n}),v.elementMoved(),e.stopPropagation(),e.preventDefault()}},updateClasses:function(){this.getDOMNode().className=this.props.pivotTableComp.pgrid.config.theme.getButtonClasses().pivotButton},render:function(){var e=this,t={left:e.state.pos.x+"px",top:e.state.pos.y+"px",position:e.state.dragging?"fixed":""};e.state.size&&(t.width=e.state.size.width+"px");var n="asc"===e.props.field.sort.order?" \u2191":"desc"===e.props.field.sort.order?" \u2193":"",a=(e.state.dragging?"":"fltr-btn")+(this.props.pivotTableComp.pgrid.isFieldFiltered(this.props.field.name)?" fltr-btn-active":""),r="";return e.props.axetype===c.Type.DATA&&(r=React.createElement("small",null," ("+e.props.field.aggregateFuncName+")")),React.createElement("div",{key:e.props.field.name,className:this.props.pivotTableComp.pgrid.config.theme.getButtonClasses().pivotButton,onMouseDown:this.onMouseDown,style:t},React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{style:{padding:0}},e.props.field.caption,r),React.createElement("td",{style:{padding:0,width:13}},n),React.createElement("td",{style:{padding:0,verticalAlign:"top"}},React.createElement("div",{className:a,onMouseDown:e.state.dragging?null:this.onFilterMouseDown}))))))}}),t.exports.PivotTableUpperButtons=l.createClass({render:function(){var e=this,t=f.PivotButton,n=f.DropTarget,a=this.props.pivotTableComp.pgridwidget.pgrid.config,r=a.availablefields().map(function(n,a){return React.createElement(t,{key:n.name,field:n,axetype:null,position:a,pivotTableComp:e.props.pivotTableComp})}),o=a.dataFields.map(function(n,a){return React.createElement(t,{key:n.name,field:n,axetype:c.Type.DATA,position:a,pivotTableComp:e.props.pivotTableComp})});return React.createElement("table",{className:"inner-table"},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"flds-grp-cap av-flds text-muted"},React.createElement("div",null,"Fields")),React.createElement("td",{className:"av-flds"},React.createElement(n,{buttons:r,axetype:null}))),React.createElement("tr",null,React.createElement("td",{className:"flds-grp-cap text-muted"},React.createElement("div",null,"Data")),React.createElement("td",{className:"empty"},React.createElement(n,{buttons:o,axetype:c.Type.DATA})))))}}),t.exports.PivotTableColumnButtons=l.createClass({render:function(){var e=this,t=f.PivotButton,n=f.DropTarget,a=this.props.pivotTableComp.pgridwidget.pgrid.config,r=a.columnFields.map(function(n,a){return React.createElement(t,{key:n.name,field:n,axetype:c.Type.COLUMNS,position:a,pivotTableComp:e.props.pivotTableComp})});return React.createElement(n,{buttons:r,axetype:c.Type.COLUMNS})}}),t.exports.PivotTableRowButtons=l.createClass({render:function(){var e=this,t=f.PivotButton,n=f.DropTarget,a=this.props.pivotTableComp.pgridwidget.pgrid.config,r=a.rowFields.map(function(n,a){return React.createElement(t,{key:n.name,field:n,axetype:c.Type.ROWS,position:a,pivotTableComp:e.props.pivotTableComp})});return React.createElement(n,{buttons:r,axetype:c.Type.ROWS})}}),t.exports.PivotTableColumnHeaders=l.createClass({render:function(){var e=this,t=f.PivotRow,n=this.props.pivotTableComp.pgridwidget,a=n.columns.headers.map(function(n,a){return React.createElement(t,{key:a,topmost:0===a,row:n,pivotTableComp:e.props.pivotTableComp})});return React.createElement("table",{className:"inner-table"},React.createElement("tbody",null,a))}}),t.exports.PivotTableRowHeaders=l.createClass({render:function(){var e=this,t=f.PivotRow,n=this.props.pivotTableComp.pgridwidget,a=n.rows.headers.map(function(n,a){return React.createElement(t,{key:a,topmost:0===a,row:n,pivotTableComp:e.props.pivotTableComp})});return React.createElement("table",{className:"inner-table"},React.createElement("tbody",null,a))}}),t.exports.PivotTableDataCells=l.createClass({render:function(){var e=this,t=f.PivotRow,n=this.props.pivotTableComp.pgridwidget,a=n.dataRows.map(function(n,a){return React.createElement(t,{key:a,topmost:0===a,row:n,pivotTableComp:e.props.pivotTableComp})});return React.createElement("table",{className:"inner-table"},React.createElement("tbody",null,a))}}),t.exports.HorizontalScrollBar=l.createClass({getInitialState:function(){return{width:16,height:16,mousedown:!1,x:0}},componentDidUpdate:function(){this.state.mousedown?this.state.mousedown&&(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)):(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},componentWillUnmount:function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},onMouseDown:function(e){if(0===e.button){var t=this.refs.scrollThumb.getDOMNode(),n=(h.getParentOffset(t),h.getParentOffset(t));this.setState({mousedown:!0,mouseoffsetX:e.pageX,x0:n.x,x:n.x}),e.stopPropagation(),e.preventDefault()}},onMouseUp:function(){if(this.setState({mousedown:!1}),this.onScoll&&this.state.x0!=this.state.x){var e=h.getSize(this.getDOMNode()).width-this.state.width;this.onScoll(this.state.x/e)}return!0},onMouseMove:function(e){if(this.state.mousedown){var t=h.getSize(this.getDOMNode()).width-this.state.width,n=this.state.x0+(e.pageX-this.state.mouseoffsetX);0>n&&(n=0),n>t&&(n=t),this.setState({x:n}),e.stopPropagation(),e.preventDefault()}},onScoll:null,setScrollComps:function(e,t,n){this.onScoll=n;var a=h.getSize(this.getDOMNode()).width;this.setState({width:h.getSize(e).width/h.getSize(t).width*a})},render:function(){return React.createElement("div",{style:{position:"relative",height:16,width:"100%"}},React.createElement("div",{style:{position:"absolute",width:this.state.width,height:this.state.height,border:"1px solid #ccc",backgroundColor:"#ddd",top:0,left:this.state.x},ref:"scrollThumb",onMouseDown:this.onMouseDown}))}}),t.exports.FilterPanel=l.createClass({pgridwidget:null,values:null,filterManager:null,getInitialState:function(){return this.pgridwidget=this.props.pivotTableComp.pgridwidget,{}},destroy:function(){var e=this.getDOMNode().parentNode;React.unmountComponentAtNode(e),e.parentNode.removeChild(e)},onFilter:function(e,t,n,a){this.props.pivotTableComp.applyFilter(this.props.field,e,t,n,a),this.destroy()},onMouseDown:function(e){for(var t=this.getDOMNode().parentNode,n=e.target;null!=n;){if(n==t)return!0;n=n.parentNode}this.destroy()},onMouseWheel:function(e){for(var t=this.getDOMNode().rows[1].cells[0].children[0],n=e.target;null!=n;){if(n==t)return void(t.scrollHeight<=t.clientHeight&&(e.stopPropagation(),e.preventDefault()));n=n.parentNode}this.destroy()},componentWillMount:function(){document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("wheel",this.onMouseWheel),window.addEventListener("resize",this.destroy)},componentDidMount:function(){this.filterManager.init(this.getDOMNode())},componentWillUnmount:function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("resize",this.destroy)},render:function(){function e(e,t){return n.push(React.createElement("tr",{key:e},React.createElement("td",{className:"fltr-chkbox"},React.createElement("input",{type:"checkbox",value:e,defaultChecked:"checked"})),React.createElement("td",{className:"fltr-val",title:t||e},t||e)))}var t=f.Dropdown,n=[];this.filterManager=new i(this,this.pgridwidget.pgrid.getFieldFilter(this.props.field)),this.values=this.pgridwidget.pgrid.getFieldValues(this.props.field),e(p.ALL,"(Show All)"),this.values.containsBlank&&e(p.BLANK,"(Blank)");for(var a=0;a<this.values.length;a++)e(this.values[a]);var r=this.props.pivotTableComp.pgrid.config.theme.getButtonClasses().orbButton,o=window.getComputedStyle(this.props.pivotTableComp.getDOMNode(),null),s={fontFamily:o.getPropertyValue("font-family"),fontSize:o.getPropertyValue("font-size")},l=this.pgridwidget.pgrid.getFieldFilter(this.props.field);return React.createElement("table",{className:"fltr-scntnr",style:s},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"srchop-col"},React.createElement(t,{values:[p.Operators.MATCH.name,p.Operators.NOTMATCH.name,p.Operators.EQ.name,p.Operators.NEQ.name,p.Operators.GT.name,p.Operators.GTE.name,p.Operators.LT.name,p.Operators.LTE.name],selectedValue:l&&l.operator?l.operator.name:p.Operators.MATCH.name,onValueChanged:this.filterManager.onOperatorChanged})),React.createElement("td",{className:"srchtyp-col",title:"Enable/disable Regular expressions"},".*"),React.createElement("td",{className:"srchbox-col"},React.createElement("input",{type:"text",placeholder:"search"}))),React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"fltr-vals-col"},React.createElement("table",{className:"fltr-vals-tbl"},React.createElement("tbody",null,n)))),React.createElement("tr",{className:"bottom-row"},React.createElement("td",{className:"cnfrm-btn-col",colSpan:"2"},React.createElement("input",{type:"button",className:r,value:"Ok",style:{"float":"left"}}),React.createElement("input",{type:"button",className:r,value:"Cancel",style:{"float":"left"}})),React.createElement("td",{className:"resize-col"},React.createElement("div",null)))))}}),t.exports.Dropdown=l.createClass({openOrClose:function(e){var t=this.refs.valueElement.getDOMNode(),n=this.refs.valuesList.getDOMNode();n.style.display=e.target===t&&"none"===n.style.display?"block":"none"},onMouseEnter:function(){var e=this.refs.valueElement.getDOMNode();e.className="orb-tgl-btn-down",e.style.backgroundPosition="right center"},onMouseLeave:function(){this.refs.valueElement.getDOMNode().className=""},componentDidMount:function(){document.addEventListener("click",this.openOrClose)},componentWillUnmount:function(){document.removeEventListener("click",this.openOrClose)},selectValue:function(e){for(var t=this.refs.valuesList.getDOMNode(),n=e.target,a=!1;!a&&null!=n;){if(n.parentNode==t){a=!0;break}n=n.parentNode}if(a){var r=n.textContent,o=this.refs.valueElement.getDOMNode();o.textContent!=r&&(o.textContent=r,this.props.onValueChanged&&this.props.onValueChanged(r))}},render:function(){for(var e=[],t=0;t<this.props.values.length;t++)e.push(React.createElement("li",{dangerouslySetInnerHTML:{__html:this.props.values[t]}}));return React.createElement("div",{className:"orb-select"},React.createElement("div",{ref:"valueElement",dangerouslySetInnerHTML:{__html:this.props.selectedValue},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}),React.createElement("ul",{ref:"valuesList",style:{display:"none"},onClick:this.selectValue},e))}}),t.exports.Grid=l.createClass({render:function(){var e=this.props.data,t=this.props.headers,n=this.props.theme.getGridClasses(),a=[];if(t&&t.length>0){for(var r=[],o=0;o<t.length;o++)r.push(React.createElement("th",{key:"h"+o},t[o]));a.push(React.createElement("tr",{key:"h"},r))}if(e&&e.length>0)for(var i=0;i<e.length;i++){for(var s=[],l=0;l<e[i].length;l++)s.push(React.createElement("td",{key:i+""+l},e[i][l]));a.push(React.createElement("tr",{key:i},s))}return React.createElement("table",{className:n.table},React.createElement("tbody",null,a))}});var x=t.exports.Dialog=l.createClass({statics:{create:function(){var e=React.createFactory(x),t=s();return{show:function(n){React.render(e(n),t)}}}},overlayElement:null,setOverlayClass:function(e){this.overlayElement.className=this.props.theme.getDialogClasses(e).overlay},componentDidMount:function(){this.overlayElement=this.getDOMNode().parentNode,this.setOverlayClass(!0),this.overlayElement.addEventListener("click",this.close);var e=this.overlayElement.children[0],t=e.children[0].children[1],n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=Math.max(document.documentElement.clientHeight,window.innerHeight||0),r=2*a/3;r=301>r?301:r;var o=e.offsetWidth+(e.offsetHeight>r?11:0),i=e.offsetHeight>r?r:e.offsetHeight;e.style.top=(a>i?(a-i)/2:0)+"px",e.style.left=(n>o?(n-o)/2:0)+"px",e.style.height=i+"px",t.style.width=o+"px",t.style.height=i-45+"px"},close:function(e){(e.target==this.overlayElement||"button-close"===e.target.className)&&(this.overlayElement.removeEventListener("click",this.close),React.unmountComponentAtNode(this.overlayElement),this.setOverlayClass(!1))},render:function(){if(this.props.comp){var e=React.createElement(this.props.comp.type,this.props.comp.props),t=this.props.theme.getDialogClasses();return React.createElement("div",{className:t.dialog,style:this.props.style||{}},React.createElement("div",{className:t.content},React.createElement("div",{className:t.header},React.createElement("div",{className:"button-close",onClick:this.close}),React.createElement("div",{className:t.title},this.props.title)),React.createElement("div",{className:t.body},e)))
}}});t.exports.Toolbar=l.createClass({onThemeChanged:function(e){this.props.pivotTableComp.changeTheme(e)},render:function(){var t=f.Dropdown,n=e("../orb.themes").themes,a=[];for(var r in n)a.push('<div style="float: left; width: 16px; height: 16px; margin-right: 3px; border: 1px dashed lightgray; background-color: '+n[r]+'"></div><div style="float: left;">'+r+"</div>");a.push('<div style="float: left; width: 16px; height: 16px; margin-right: 3px; border: 1px dashed lightgray;"></div><div style="float: left;">bootstrap</div>');var o=[React.createElement("div",{className:"orb-tlbr-btn",style:{width:101}},React.createElement(t,{values:a,selectedValue:"Theme",onValueChanged:this.onThemeChanged}))];return React.createElement("div",null,o)}})},{"../orb.axe":3,"../orb.filtering":6,"../orb.themes":10,"../orb.ui.header":12,"../orb.utils":15,"./orb.react.utils":17,react:void 0}],17:[function(e,t){t.exports.forEach=function(e,t,n){var a;if(null!=e)for(var r=0,o=e.length;o>r&&(a=t(e[r],r),void 0===a||n!==!0);r++);return a},t.exports.getOffset=function(e){if(null!=e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top}}return{x:0,y:0}},t.exports.getParentOffset=function(e){if(null!=e){var t=e.getBoundingClientRect(),n=null!=e.parentNode?e.parentNode.getBoundingClientRect():{top:0,left:0};return{x:t.left-n.left,y:t.top-n.top}}return{x:0,y:0}},t.exports.getSize=function(e){if(null!=e){var t=e.getBoundingClientRect();return{width:t.right-t.left,height:t.bottom-t.top}}return{width:0,height:0}}},{}]},{},[1])(1)});

//# sourceMappingURL=orb-1.0.8.min.js.map