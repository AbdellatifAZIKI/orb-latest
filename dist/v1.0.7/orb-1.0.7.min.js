/**
 * orb v1.0.7, Pivot grid javascript library.
 *
 * Copyright (c) 2014-2015 Najmeddine Nouri <devnajm@gmail.com>.
 *
 * @version v1.0.7
 * @link http://nnajm.github.io/orb/
 * @license MIT
 */

"use strict";!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.orb=e()}}(function(){return function e(t,n,r){function a(o,l){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return a(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t){t.exports.utils=e("./orb.utils"),t.exports.pgrid=e("./orb.pgrid"),t.exports.pgridwidget=e("./orb.ui.pgridwidget"),t.exports.query=e("./orb.query")},{"./orb.pgrid":7,"./orb.query":8,"./orb.ui.pgridwidget":12,"./orb.utils":14}],2:[function(e,t){function n(e,t,n,a){var i=0,o=0,l=("all"===t?n:t).length;return l>0&&(a||l>1?(r(e,t,n,function(e){o+=e}),o/=l,r(e,t,n,function(e){i+=(e-o)*(e-o)}),i/=a?l:l-1):i=0/0),i}function r(e,t,n,r){var a="all"===t;if(t=a?n:t,t.length>0)for(var i=0;i<t.length;i++)r((a?t[i]:n[t[i]])[e])}var a=t.exports={toAggregateFunc:function(e){return e?"string"==typeof e&&a[e]?a[e]:"function"==typeof e?e:a.sum:a.sum},count:function(e,t,n){return"all"===t?n.length:t.length},sum:function(e,t,n){var a=0;return r(e,t,n,function(e){a+=e}),a},min:function(e,t,n){var a=null;return r(e,t,n,function(e){(null==a||a>e)&&(a=e)}),a},max:function(e,t,n){var a=null;return r(e,t,n,function(e){(null==a||e>a)&&(a=e)}),a},avg:function(e,t,n){var a=0,i=("all"===t?n:t).length;return i>0&&(r(e,t,n,function(e){a+=e}),a/=i),a},prod:function(e,t,n){var a,i=("all"===t?n:t).length;return i>0&&(a=1,r(e,t,n,function(e){a*=e})),a},stdev:function(e,t,r){return Math.sqrt(n(e,t,r,!1))},stdevp:function(e,t,r){return Math.sqrt(n(e,t,r,!0))},"var":function(e,t,r){return n(e,t,r,!1)},varp:function(e,t,r){return n(e,t,r,!0)}}},{}],3:[function(e,t){var n=e("./orb.utils"),r=e("./orb.dimension"),a={COLUMNS:1,ROWS:2,DATA:3};t.exports=function(e,t){function i(e){for(var t=0;t<l.fields.length;t++)if(l.fields[t].name===e.name)return t;return-1}function o(){if(null!=l.pgrid.filteredDataSource&&l.dimensionsCount>0){var e=l.pgrid.filteredDataSource;if(null!=e&&n.isArray(e)&&e.length>0)for(var t=0,a=e.length;a>t;t++)for(var i=e[t],o=l.root,u=0;u<l.dimensionsCount;u++){var c=l.dimensionsCount-u,d=l.fields[u],p=i[d.name],h=o.subdimvals;void 0!==h[p]?o=h[p]:(o.values.push(p),o=new r(++s,o,p,d,c,!1,u==l.dimensionsCount-1),h[p]=o,o.rowIndexes=[],l.dimensionsByDepth[c].push(o)),o.rowIndexes.push(t)}}}var l=this,s=0;null!=e&&null!=e.config&&(this.pgrid=e,this.type=t,this.fields=function(){switch(t){case a.COLUMNS:return l.pgrid.config.columnFields;case a.ROWS:return l.pgrid.config.rowFields;case a.DATA:return l.pgrid.config.dataFields;default:return[]}}(),this.dimensionsCount=null,this.root=null,this.dimensionsByDepth=null,this.update=function(){l.dimensionsCount=l.fields.length,l.root=new r(++s,null,null,null,l.dimensionsCount+1,!0),l.dimensionsByDepth={};for(var e=1;e<=l.dimensionsCount;e++)l.dimensionsByDepth[e]=[];o();for(var t=0;t<l.fields.length;t++){var n=l.fields[t];("asc"===n.sort.order||"desc"===n.sort.order)&&l.sort(n,!0)}},this.sort=function(e,t){if(null!=e){t!==!0&&(e.sort.order="asc"!==e.sort.order?"asc":"desc");for(var n=l.dimensionsCount-i(e),r=n===l.dimensionsCount?[l.root]:l.dimensionsByDepth[n+1],a=0;a<r.length;a++)r[a].values.sort(),"desc"===e.sort.order&&r[a].values.reverse()}})},t.exports.Type=a},{"./orb.dimension":5,"./orb.utils":14}],4:[function(e,t){function n(e,t,n){for(var r=0;r<t.length;r++)if(null!=t[r][e])return t[r][e];return n}function r(){for(var e=[],t=[],r=[],a=[],i=[],o=0;o<arguments.length;o++){var l=arguments[o]||{};e.push(l),t.push(l.sort||{}),r.push(l.subTotal||{}),a.push(l.filter||{}),i.push({aggregateFunc:0===o?l.aggregateFunc:l.aggregateFunc?l.aggregateFunc():null,formatFunc:0===o?l.formatFunc:l.formatFunc?l.formatFunc():null})}return new h({name:n("name",e,""),caption:n("caption",e,""),filter:{type:n("type",a,"operator"),regexp:n("regexp",a,null),operator:n("operator",a,null),value:n("value",a,null)},sort:{order:n("order",t,null),customfunc:n("customfunc",t,null)},subTotal:{visible:n("visible",r,!0),collapsible:n("collapsible",r,!0),collapsed:n("collapsed",r,!1)},aggregateFunc:n("aggregateFunc",i,null),formatFunc:n("formatFunc",i,null)},!1)}function a(e,t,n,a){var i;if(a)switch(t){case c.Type.ROWS:i=a.rowSettings;break;case c.Type.COLUMNS:i=a.columnSettings;break;case c.Type.DATA:i=a.dataSettings;break;default:i=null}else i=null;return r(n,i,a,e)}function i(e){e=e||{},this.rowsvisible=void 0!==e.rowsvisible?e.rowsvisible:!0,this.columnsvisible=void 0!==e.columnsvisible?e.columnsvisible:!0}function o(e,t){var n={visible:t===!0?!0:void 0,collapsible:t===!0?!0:void 0,collapsed:t===!0?!1:void 0};e=e||{},this.visible=void 0!==e.visible?e.visible:n.visible,this.collapsible=void 0!==e.collapsible?e.collapsible:n.collapsible,this.collapsed=void 0!==e.collapsed?e.collapsed:n.collapsed}function l(e){e=e||{},this.order=e.order,this.customfunc=e.customfunc}function s(e){e=e||{},this.type=e.type,this.operator=e.operator,this.value=e.value,this.values=e.values}var u=e("./orb.utils"),c=e("./orb.axe"),d=e("./orb.aggregation"),p=e("./orb.filtering"),h=t.exports.field=function(e,t){function n(e){return e?e.toString():""}e=e||{},this.name=e.name,this.caption=e.caption||this.name,this.filter=new s(e.filter),this.sort=new l(e.sort),this.subTotal=new o(e.subTotal);var r,a;this.aggregateFunc=function(e){return e?void(r=d.toAggregateFunc(e)):r},this.formatFunc=function(e){return e?void(a=e):a},this.aggregateFunc(e.aggregateFunc||"sum"),this.formatFunc(e.formatFunc||n),t!==!1&&((this.rowSettings=new h(e.rowSettings,!1)).name=this.name,(this.columnSettings=new h(e.columnSettings,!1)).name=this.name,(this.dataSettings=new h(e.dataSettings,!1)).name=this.name)};t.exports.config=function(e){function t(e){return"string"==typeof e?{name:l.captionToName(e)}:e}function n(e,t){var n=r(e,t);return n>-1?e[n]:null}function r(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}var l=this;this.dataSource=e.dataSource||[],this.dataHeadersLocation="columns"===e.dataHeadersLocation?"columns":"rows",this.grandTotal=new i(e.grandTotal),this.subTotal=new o(e.subTotal,!0),this.width=e.width,this.height=e.height,this.theme=(e.theme||"blue").toString().trim(),this.dataSourceFieldNames=[],this.dataSourceFieldCaptions=[],this.captionToName=function(e){var t=l.dataSourceFieldCaptions.indexOf(e);return t>=0?l.dataSourceFieldNames[t]:e},this.nameToCaption=function(e){var t=l.dataSourceFieldNames.indexOf(e);return t>=0?l.dataSourceFieldCaptions[t]:e},this.allFields=(e.fields||[]).map(function(e){var t=new h(e);return l.dataSourceFieldNames.push(t.name),l.dataSourceFieldCaptions.push(t.caption),t}),this.rowFields=(e.rows||[]).map(function(e){return e=t(e),a(l,c.Type.ROWS,e,n(l.allFields,e.name))}),this.columnFields=(e.columns||[]).map(function(e){return e=t(e),a(l,c.Type.COLUMNS,e,n(l.allFields,e.name))}),this.dataFields=(e.data||[]).map(function(e){return e=t(e),a(l,c.Type.DATA,e,n(l.allFields,e.name))}),this.dataFieldsCount=this.dataFields?this.dataFields.length||1:1,this.getField=function(e){return n(l.allFields,e)},this.getRowField=function(e){return n(l.rowFields,e)},this.getColumnField=function(e){return n(l.columnFields,e)},this.getDataField=function(e){return n(l.dataFields,e)},this.availablefields=function(){return l.allFields.filter(function(e){var t=function(t){return e.name!==t.name};return l.dataFields.every(t)&&l.rowFields.every(t)&&l.columnFields.every(t)})},this.getDataSourceFieldCaptions=function(){var e;if(l.dataSource&&(e=l.dataSource[0])){for(var t=u.ownProperties(e),n=[],r=0;r<t.length;r++)n.push(l.nameToCaption(t[r]));return n}return null},this.getPreFilters=function(){var t={};return e.preFilters&&u.ownProperties(e.preFilters).forEach(function(n){var r=e.preFilters[n];if(u.isArray(r))t[l.captionToName(n)]=new p.expressionFilter(null,null,r,!1);else{var a=u.ownProperties(r)[0];a&&(t[l.captionToName(n)]=new p.expressionFilter(a,r[a]))}}),t},this.moveField=function(e,t,i,o){var s,u,d,p=n(l.allFields,e);if(p){switch(t){case c.Type.ROWS:s=l.rowFields;break;case c.Type.COLUMNS:s=l.columnFields;break;case c.Type.DATA:s=l.dataFields}switch(i){case c.Type.ROWS:d=l.rowFields;break;case c.Type.COLUMNS:d=l.columnFields;break;case c.Type.DATA:d=l.dataFields}if(s||d){if(s){if(u=r(s,e),t===i&&(u==s.length-1&&null==o||u===o-1))return!1;s.splice(u,1)}return p=a(l,i,null,p),d&&(null!=o?d.splice(o,0,p):d.push(p)),l.dataFieldsCount=l.dataFields?l.dataFields.length||1:1,!0}}}}},{"./orb.aggregation":2,"./orb.axe":3,"./orb.filtering":6,"./orb.utils":14}],5:[function(e,t){t.exports=function(e,t,n,r,a,i,o){var l=this;this.id=e,this.parent=t,this.value=n,this.isRoot=i,this.isLeaf=o,this.field=r,this.depth=a,this.values=[],this.subdimvals={},this.rowIndexes=null,this.getRowIndexes=function(e){if(null==l.rowIndexes){l.rowIndexes=[];for(var t=0;t<l.values.length;t++)l.subdimvals[l.values[t]].getRowIndexes(l.rowIndexes)}if(null!=e){for(var n=0;n<l.rowIndexes.length;n++)e.push(l.rowIndexes[n]);return e}return l.rowIndexes}}},{}],6:[function(e,t){var n=e("./orb.utils"),r=t.exports={ALL:"#All#",NONE:"#None#",BLANK:'#Blank#"'};r.expressionFilter=function(e,t,i,o){var l=this;this.operator=a.get(e),this.regexpMode=!1,this.term=t||null,this.term&&this.operator&&this.operator.regexpSupported&&n.isRegExp(this.term)&&(this.regexpMode=!0,this.term.ignoreCase||(this.term=new RegExp(this.term.source,"i"))),this.staticValue=i,this.excludeStatic=o,this.test=function(e){if(n.isArray(l.staticValue)){var t=l.staticValue.indexOf(e)>=0;return l.excludeStatic&&!t||!l.excludeStatic&&t}return l.term?l.operator.func(e,l.term):l.staticValue===!0||l.staticValue===r.ALL?!0:l.staticValue===!1||l.staticValue===r.NONE?!1:!0},this.isAlwaysTrue=function(){return!(l.term||n.isArray(l.staticValue)||l.staticValue===r.NONE||l.staticValue===!1)}};var a=r.Operators={get:function(e){switch(e){case a.MATCH.name:return a.MATCH;case a.NOTMATCH.name:return a.NOTMATCH;case a.EQ.name:return a.EQ;case a.NEQ.name:return a.NEQ;case a.GT.name:return a.GT;case a.GTE.name:return a.GTE;case a.LT.name:return a.LT;case a.LTE.name:return a.LTE;default:return a.NONE}},NONE:null,MATCH:{name:"Match",func:function(e,t){return e?e.toString().search(n.isRegExp(t)?t:new RegExp(t,"i"))>=0:!t},regexpSupported:!0},NOTMATCH:{name:"Does Not Match",func:function(e,t){return e?e.toString().search(n.isRegExp(t)?t:new RegExp(t,"i"))<0:!!t},regexpSupported:!0},EQ:{name:"=",func:function(e,t){return e==t},regexpSupported:!1},NEQ:{name:"<>",func:function(e,t){return e!=t},regexpSupported:!1},GT:{name:">",func:function(e,t){return e>t},regexpSupported:!1},GTE:{name:">=",func:function(e,t){return e>=t},regexpSupported:!1},LT:{name:"<",func:function(e,t){return t>e},regexpSupported:!1},LTE:{name:"<=",func:function(e,t){return t>=e},regexpSupported:!1}}},{"./orb.utils":14}],7:[function(e,t){var n=e("./orb.axe"),r=e("./orb.config").config,a=e("./orb.filtering"),i=e("./orb.query"),o=e("./orb.utils");t.exports=function(e){function t(e){e!==!1&&l(),h.rows.update(),h.columns.update(),c()}function l(){var e=o.ownProperties(h.filters);if(e.length>0){h.filteredDataSource=[];for(var t=0;t<h.config.dataSource.length;t++){for(var n=h.config.dataSource[t],r=!1,a=0;a<e.length;a++){var i=e[a],l=h.filters[i];if(l&&!l.test(n[i])){r=!0;break}}r||h.filteredDataSource.push(n)}}else h.filteredDataSource=h.config.dataSource}function s(e,t,n,r,a){var i={};if(h.config.dataFieldsCount>0){var o;if(null==e)o=t;else if(null==t)o=e;else{o=[];for(var l=0;l<e.length;l++){var s=e[l];if(s>=0){var u=t.indexOf(s);u>=0&&(e[l]=0-(s+2),o.push(s))}}}var c,d=(h.filteredDataSource,[]);if(r)for(var f=0;f<r.length;f++)c=h.config.getDataField(r[f]),a||(c?a=c.aggregateFunc():(c=h.config.getField(r[f]),c&&(a=c.dataSettings?c.dataSettings.aggregateFunc():c.aggregateFunc()))),c&&a&&d.push({field:c,aggregateFunc:a});else for(var g=0;g<h.config.dataFieldsCount;g++)c=h.config.dataFields[g]||p,(a||c.aggregateFunc)&&d.push({field:c,aggregateFunc:a||c.aggregateFunc()});for(var m=0;m<d.length;m++)c=d[m],i[c.field.name]=c.aggregateFunc(c.field.name,o||"all",h.filteredDataSource,n||e,t)}return i}function u(e){if(e){var t={},n="r"+e.id;if(void 0===d[n]&&(d[n]=e.isRoot?null:d[e.parent.id]||e.getRowIndexes()),t[h.columns.root.id]=s(e.isRoot?null:d[n].slice(0),null),h.columns.dimensionsCount>0)for(var r=0,a=[h.columns.root];r<a.length;){for(var i=a[r],o=e.isRoot?null:i.isRoot?d[n].slice(0):d["c"+i.id].slice(0),l=0;l<i.values.length;l++){var u=i.subdimvals[i.values[l]],c="c"+u.id;if(void 0===d[c]&&(d[c]=d[c]||u.getRowIndexes().slice(0)),t[u.id]=s(o,d[c],e.isRoot?null:e.getRowIndexes()),!u.isLeaf&&(a.push(u),o)){d[c]=[];for(var p=0;p<o.length;p++){var f=o[p];-1!=f&&0>f&&(d[c].push(0-(f+2)),o[p]=-1)}}}d["c"+i.id]=void 0,r++}return t}}function c(){if(h.dataMatrix={},d={},h.dataMatrix[h.rows.root.id]=u(h.rows.root),h.rows.dimensionsCount>0)for(var e,t=[h.rows.root],n=0;n<t.length;){e=t[n];for(var r=0;r<e.values.length;r++){var a=e.subdimvals[e.values[r]];h.dataMatrix[a.id]=u(a),a.isLeaf||t.push(a)}n++}}var d,p={name:"#undefined#"},h=this;this.config=new r(e),this.filters=h.config.getPreFilters(),this.filteredDataSource=h.config.dataSource,this.rows=new n(h,n.Type.ROWS),this.columns=new n(h,n.Type.COLUMNS),this.dataMatrix={},this.moveField=function(e,n,r,a){h.config.moveField(e,n,r,a)&&t(!1)},this.applyFilter=function(e,n,r,i,o){h.filters[e]=new a.expressionFilter(n,r,i,o),t()},this.refreshData=function(e){h.config.dataSource=e,t()},this.getFieldValues=function(e,t){for(var n=[],r=[],a=!1,i=0;i<h.config.dataSource.length;i++){var l=h.config.dataSource[i],s=l[e];void 0!==t?(t===!0||"function"==typeof t&&t(s))&&n.push(s):s?n.push(s):a=!0}if(n.length>1){o.isNumber(n[0])||o.isDate(n[0])?n.sort(function(e,t){return e?t?e-t:1:t?-1:0}):n.sort();for(var u=0;u<n.length;u++)(0===u||n[u]!==r[r.length-1])&&r.push(n[u])}else r=n;return r.containsBlank=a,r},this.getFieldFilter=function(e){return h.filters[e]},this.isFieldFiltered=function(e){var t=h.getFieldFilter(e);return null!=t&&!t.isAlwaysTrue()},this.getData=function(e,t,n,r){if(t&&n){var a=e||(h.config.dataFields[0]||p).name,i=h.config.getDataField(a);return!i||r&&i.aggregateFunc!=r?h.calcAggregation(t.getRowIndexes().slice(0),n.getRowIndexes().slice(0),[a],r)[a]||null:h.dataMatrix[t.id]&&h.dataMatrix[t.id][n.id]?h.dataMatrix[t.id][n.id][a]||null:null}},this.calcAggregation=function(e,t,n,r){return s(e,t,e,n,r)},this.query=i(h),t()}},{"./orb.axe":3,"./orb.config":4,"./orb.filtering":6,"./orb.query":8,"./orb.utils":14}],8:[function(e,t){var n=e("./orb.utils"),r=e("./orb.axe"),a=e("./orb.aggregation"),i=function(e,t,r){var i=this;this.source=e,this.query=t,this.filters=r,this.extractResult=function(e,t,n){if(n.multi===!0){for(var r={},a=0;a<t.multiFieldNames.length;a++)r[t.multiFieldNames[a]]=e[i.getCaptionName(t.multiFieldNames[a])];return r}return e[n.datafieldname]},this.measureFunc=function(e,t,n,r){var a={datafieldname:i.getCaptionName(e),multi:t,aggregateFunc:n};return function(e){e=i.cleanOptions(e,arguments,a);var n=i.compute(e,r,t);return i.extractResult(n,e,a)}},this.setDefaultAggFunctions=function(e){var t=i.query.val?"val_":"val";i.query[t]=i.measureFunc(void 0,!0,void 0,e);for(var r=n.ownProperties(a),o=0;o<r.length;o++){var l=r[o];"toAggregateFunc"!==l&&(i.query[l]=i.measureFunc(void 0,!0,a[l],e))}}},o=function(e){function t(e,t){return function(n){return n.value===t.val&&(!e||e.some(function(e){var t=n.parent;if(t)for(;t.depth<e.depth;)t=t.parent;return t===e}))}}i.call(this,e,{},{});var n=this;this.getCaptionName=function(e){return n.source.config.captionToName(e)},this.cleanOptions=function(e,t,r){var i={fieldNames:[]};if(r.multi===!0){e&&"object"==typeof e?(i.aggregateFunc=e.aggregateFunc,i.multiFieldNames=e.fields):(i.aggregateFunc=r.aggregateFunc,i.multiFieldNames=t);for(var o=0;o<i.multiFieldNames.length;o++)i.fieldNames.push(n.getCaptionName(i.multiFieldNames[o]))}else i.aggregateFunc=e,i.fieldNames.push(r.datafieldname);return i.aggregateFunc&&(i.aggregateFunc=a.toAggregateFunc(i.aggregateFunc)),i},this.setup=function(e){var t,a=n.source.config.rowFields,i=n.source.config.columnFields,o=n.source.config.dataFields;for(t=0;t<a.length;t++)n.slice(a[t],r.Type.ROWS,a.length-t);for(t=0;t<i.length;t++)n.slice(i[t],r.Type.COLUMNS,i.length-t);for(t=0;t<o.length;t++){var l=o[t],s=l.name,u=l.caption||s;n.query[s]=n.query[u]=n.measureFunc(s)}if(e)for(var c in e)e.hasOwnProperty(c)&&n.query[c](e[c]);return n.setDefaultAggFunctions(),n.query},this.slice=function(e,t,r){n.query[e.name]=n.query[e.caption||e.name]=function(a){var i={name:e.name,val:a,depth:r};return(n.filters[t]=n.filters[t]||[]).push(i),n.query}},this.applyFilters=function(e){if(n.filters[e]){for(var a=n.filters[e].sort(function(e,t){return t.depth-e.depth}),i=n.source[e===r.Type.ROWS?"rows":"columns"],o=0,l=null;o<a.length;){var s=a[o];l=i.dimensionsByDepth[s.depth].filter(t(l,s)),o++}return l}return null},this.compute=function(e){var t,a=n.applyFilters(r.Type.ROWS)||[n.source.rows.root],i=n.applyFilters(r.Type.COLUMNS)||[n.source.columns.root];if(1===a.length&&1===i.length){t={};for(var o=0;o<e.fieldNames.length;o++)t[e.fieldNames[o]]=n.source.getData(e.fieldNames[o],a[0],i[0],e.aggregateFunc)}else{for(var l=[],s=[],u=0;u<a.length;u++)l=l.concat(a[u].getRowIndexes());for(var c=0;c<i.length;c++)s=s.concat(i[c].getRowIndexes());t=n.source.calcAggregation(l,s,e.fieldNames,e.aggregateFunc)}return t}},l=function(e){i.call(this,e,{},[]);var t=this,r={};this.setCaptionName=function(e,t){r[e||t]=t},this.getCaptionName=function(e){return r[e]||e},this.cleanOptions=function(e,n,r){var a={fieldNames:[]};if(r.multi===!0){e&&"object"==typeof e?(a.aggregateFunc=e.aggregateFunc,a.multiFieldNames=e.fields):(a.aggregateFunc=r.aggregateFunc,a.multiFieldNames=n);for(var i=0;i<a.multiFieldNames.length;i++)a.fieldNames.push(t.getCaptionName(a.multiFieldNames[i]))}else a.aggregateFunc=e||r.aggregateFunc,a.fieldNames.push(r.datafieldname);return a},this.setup=function(e){if(t.query.slice=function(e,n){var r={name:e,val:n};return t.filters.push(r),t.query},e)for(var r=n.ownProperties(e),a=0;a<r.length;a++){var i=r[a],o=e[i],l=o.caption||o.name;o.name=i,t.setCaptionName(l,i),o.toAggregate?t.query[i]=t.query[l]=t.measureFunc(i,!1,o.aggregateFunc):t.slice(o)}return t.setDefaultAggFunctions(e),t.query},this.slice=function(e){t.query[e.name]=t.query[e.caption||e.name]=function(n){return t.query.slice(e.name,n)}},this.applyFilters=function(){for(var e=[],n=0;n<t.source.length;n++){for(var r=t.source[n],a=!0,i=0;i<t.filters.length;i++){var o=t.filters[i];if(r[o.name]!==o.val){a=!1;break}}a&&e.push(n)}return e},this.compute=function(e,n,r){for(var i=t.applyFilters(),o={},l=0;l<e.fieldNames.length;l++){var s=e.fieldNames[l],u=a.toAggregateFunc(r===!0?e.aggregateFunc||(n&&n[s]?n[s].aggregateFunc:void 0):e.aggregateFunc);o[s]=u(s,i||"all",t.source,i,null)}return o}};t.exports=function(e,t){return n.isArray(e)?new l(e).setup(t):function(t){return new o(e).setup(t)}}},{"./orb.aggregation":2,"./orb.axe":3,"./orb.utils":14}],9:[function(e,t){t.exports=function(){var e={};this.set=function(t,n){e[t]=n},this.get=function(t){return e[t]}}},{}],10:[function(e,t){var n=e("./orb.axe"),r=e("./orb.ui.header");t.exports=function(e){function t(){function e(e){e&&e.dim.field.subTotal.visible&&t.push(e.subtotalHeader)}var t=[];if(i.uiInfos.length>0){for(var n,a=i.uiInfos[i.uiInfos.length-1],s=a[0],u=s.parent,c=0;c<a.length;c++){if(s=a[c],n=s.parent,n!=u){if(e(u),null!=n)for(var d=n.parent,p=u?u.parent:null;d!=p&&null!=p;)e(p),d=d?d.parent:null,p=p?p.parent:null;u=n}if(t.push(a[c]),c===a.length-1)for(;null!=u;)e(u),u=u.parent}i.axe.pgrid.config.grandTotal.columnsvisible&&i.axe.dimensionsCount>1&&t.push(i.uiInfos[0][i.uiInfos[0].length-1])}if(o){i.leafsHeaders=[];for(var h=0;h<t.length;h++)for(var f=0;l>f;f++)i.leafsHeaders.push(new r.dataHeader(i.axe.pgrid.config.dataFields[f],t[h]));i.uiInfos.push(i.leafsHeaders)}else i.leafsHeaders=t}function a(e,t){for(var a=t[t.length-1],o=i.axe.root.depth===e?[null]:t[i.axe.root.depth-e-1].filter(function(e){return e.type!==r.HeaderType.SUB_TOTAL}),s=0;s<o.length;s++)for(var u=o[s],c=null==u?i.axe.root:u.dim,d=0;d<c.values.length;d++){var p,h=c.values[d],f=c.subdimvals[h];p=!f.isLeaf&&f.field.subTotal.visible?new r.header(n.Type.COLUMNS,r.HeaderType.SUB_TOTAL,f,u,l):null;var g=new r.header(n.Type.COLUMNS,null,f,u,l,p);a.push(g),!f.isLeaf&&f.field.subTotal.visible&&a.push(p)}}var i=this;this.axe=e,this.uiInfos=null,this.leafsHeaders=null;var o,l;this.build=function(){if(l="columns"===i.axe.pgrid.config.dataHeadersLocation?i.axe.pgrid.config.dataFieldsCount:1,o="columns"===i.axe.pgrid.config.dataHeadersLocation&&l>1,i.uiInfos=[],null!=i.axe){for(var e=i.axe.root.depth;e>1;e--)i.uiInfos.push([]),a(e,i.uiInfos);i.axe.pgrid.config.grandTotal.columnsvisible&&(i.uiInfos[0]=i.uiInfos[0]||[]).push(new r.header(n.Type.COLUMNS,r.HeaderType.GRAND_TOTAL,i.axe.root,null,l)),0===i.uiInfos.length&&i.uiInfos.push([new r.header(n.Type.COLUMNS,r.HeaderType.INNER,i.axe.root,null,l)]),t()}},this.build()}},{"./orb.axe":3,"./orb.ui.header":11}],11:[function(e,t){function n(e){this.axetype=e.axetype,this.type=e.type,this.template=e.template,this.value=e.value,this.expanded=!0,this.cssclass=e.cssclass,this.hspan=e.hspan||function(){return 1},this.vspan=e.vspan||function(){return 1},this.visible=e.isvisible||function(){return!0},this.key=this.axetype+this.type+this.value,this.getState=function(){return a.get(this.key)},this.setState=function(e){a.set(this.key,e)}}var r=e("./orb.axe"),a=new(e("./orb.state")),i=t.exports.HeaderType={EMPTY:1,DATA_HEADER:2,DATA_VALUE:3,FIELD_BUTTON:4,INNER:5,WRAPPER:6,SUB_TOTAL:7,GRAND_TOTAL:8,getHeaderClass:function(e,t){var n=t===r.Type.ROWS?"header-row":t===r.Type.COLUMNS?"header-col":"";switch(e){case i.EMPTY:case i.FIELD_BUTTON:n="empty";break;case i.INNER:n="header "+n;break;case i.WRAPPER:n="header "+n;break;case i.SUB_TOTAL:n="header header-st "+n;break;case i.GRAND_TOTAL:n="header header-gt "+n}return n},getCellClass:function(e,t){var n="";switch(e){case i.GRAND_TOTAL:n="cell-gt";break;case i.SUB_TOTAL:n=t===i.GRAND_TOTAL?"cell-gt":"cell-st";break;default:n=t===i.GRAND_TOTAL?"cell-gt":t===i.SUB_TOTAL?"cell-st":"cell"}return n}};t.exports.header=function(e,t,a,o,l,s){function u(){if(f.type===i.SUB_TOTAL){for(var e=f.parent;null!=e;){if(e.subtotalHeader&&!e.subtotalHeader.expanded)return!1;e=e.parent}return!0}var t=f.dim.isRoot||f.dim.isLeaf||!f.dim.field.subTotal.visible||f.subtotalHeader.expanded;if(!t)return!1;for(var n=f.parent;null!=n&&(!n.dim.field.subTotal.visible||null!=n.subtotalHeader&&n.subtotalHeader.expanded);)n=n.parent;return null==n||null==n.subtotalHeader?t:n.subtotalHeader.expanded}function c(){var e,t=0,n=!1;if(f.visible()){if(f.dim.isLeaf)return l;for(var r=0;r<f.subheaders.length;r++){var a=f.subheaders[r];a.dim.isLeaf?t+=l:(e=g?a.vspan():a.hspan(),t+=e,0===r&&(0===e||g&&a.type===i.SUB_TOTAL&&!a.expanded)&&(n=!0))}return t+(n?1:0)}return t}var d,p,h,f=this,g=e===r.Type.ROWS;switch(t=t||(1===a.depth?i.INNER:i.WRAPPER)){case i.GRAND_TOTAL:h="Grand Total",d=g?a.depth-1||1:l,p=g?l:a.depth-1||1;break;case i.SUB_TOTAL:h="Total "+a.value,d=g?a.depth:l,p=g?l:a.depth;break;default:h=a.value,d=g?1:null,p=g?null:1}n.call(this,{axetype:e,type:t,template:g?"cell-template-row-header":"cell-template-column-header",value:h,cssclass:i.getHeaderClass(t,e),hspan:null!=d?function(){return d}:c,vspan:null!=p?function(){return p}:c,isvisible:u}),this.subtotalHeader=s,this.parent=o,this.subheaders=[],this.dim=a,this.expanded=this.getState()?this.getState().expanded:t!==i.SUB_TOTAL||!a.field.subTotal.collapsed,this.expand=function(){f.expanded=!0,this.setState({expanded:f.expanded})},this.collapse=function(){f.expanded=!1,this.setState({expanded:f.expanded})},null!=o&&o.subheaders.push(this)},t.exports.dataHeader=function(e,t){n.call(this,{axetype:null,type:i.DATA_HEADER,template:"cell-template-dataheader",value:e,cssclass:i.getHeaderClass(t.type,t.axetype),isvisible:t.visible}),this.parent=t},t.exports.dataCell=function(e,t,r,a){this.rowDimension=r.type===i.DATA_HEADER?r.parent.dim:r.dim,this.columnDimension=a.type===i.DATA_HEADER?a.parent.dim:a.dim,this.rowType=r.type===i.DATA_HEADER?r.parent.type:r.type,this.colType=a.type===i.DATA_HEADER?a.parent.type:a.type,this.datafield=e.config.dataFieldsCount>1?"rows"===e.config.dataHeadersLocation?r.value:a.value:e.config.dataFields[0],n.call(this,{axetype:null,type:i.DATA_VALUE,template:"cell-template-datavalue",value:e.getData(this.datafield?this.datafield.name:null,this.rowDimension,this.columnDimension),cssclass:"cell "+i.getCellClass(this.rowType,this.colType),isvisible:t})},t.exports.buttonCell=function(e){n.call(this,{axetype:null,type:i.FIELD_BUTTON,template:"cell-template-fieldbutton",value:e,cssclass:i.getHeaderClass(i.FIELD_BUTTON)})},t.exports.emptyCell=function(e,t){n.call(this,{axetype:null,type:i.EMPTY,template:"cell-template-empty",value:null,cssclass:i.getHeaderClass(i.EMPTY),hspan:function(){return e},vspan:function(){return t}})}},{"./orb.axe":3,"./orb.state":9}],12:[function(e,t){var n=e("./orb.axe"),r=e("./orb.pgrid"),a=e("./orb.ui.header"),i=e("./orb.ui.rows"),o=e("./orb.ui.cols"),l=e("./react/orb.react.compiled");t.exports=function(e){function t(){function e(e,t){return e.length!==t?(e.length=t,!0):!1}function t(e,t){return function(){return e()&&t()}}u.rows=new i(u.pgrid.rows),u.columns=new o(u.pgrid.columns);var n=u.rows.uiInfos,r=n.length,l=u.columns.uiInfos,s=l.length,c=u.columns.leafsHeaders,d=c.length;u.rowHeadersWidth=(u.pgrid.rows.fields.length||1)+("rows"===u.pgrid.config.dataHeadersLocation&&u.pgrid.config.dataFieldsCount>1?1:0),u.columnHeadersWidth=d,u.rowHeadersHeight=r,u.columnHeadersHeight=(u.pgrid.columns.fields.length||1)+("columns"===u.pgrid.config.dataHeadersLocation&&u.pgrid.config.dataFieldsCount>1?1:0),u.totalWidth=u.rowHeadersWidth+u.columnHeadersWidth,u.totalHeight=u.rowHeadersHeight+u.columnHeadersHeight;var p=[];e(p,s+r);for(var h,f=0;s>f;f++){var g=l[f],m=0;if(h=p[f]=p[f]||[],s>1&&0===f)m=1,e(h,m+g.length),h[0]=new a.emptyCell(u.rowHeadersWidth,u.columnHeadersHeight-1);else if(f===s-1)if(m=u.rowHeadersWidth,e(h,m+g.length),u.pgrid.rows.fields.length>0)for(var v=0;v<u.pgrid.config.rowFields.length;v++)h[v]=new a.buttonCell(u.pgrid.config.rowFields[v]);else h[0]=new a.emptyCell(u.rowHeadersWidth,1);for(var y=0;y<g.length;y++)h[m+y]=g[y]}for(var b=0;r>b;b++){var x=n[b];h=p[s+b]=p[s+b]||new Array(x.length+d),e(h,x.length+d);for(var w=0;w<x.length;w++)h[w]=x[w];for(var T=x[x.length-1],E=0;d>E;E++){var R=c[E],N=t(T.visible,R.visible);h[x.length+E]=new a.dataCell(u.pgrid,N,T,R)}}u.cells=p}var s,u=this;this.pgrid=new r(e),this.rows=null,this.columns=null,this.rowHeadersWidth=null,this.columnHeadersWidth=null,this.rowHeadersHeight=null,this.columnHeadersHeight=null,this.totalWidth=null,this.totalWidth=null,this.sort=function(e,r){if(e===n.Type.ROWS)u.pgrid.rows.sort(r);else{if(e!==n.Type.COLUMNS)return;u.pgrid.columns.sort(r)}t()},this.refreshData=function(e){u.pgrid.refreshData(e),t(),c.forceUpdate()},this.applyFilter=function(e,n,r,a,i){u.pgrid.applyFilter(e,n,r,a,i),t(),c.forceUpdate()},this.moveField=function(e,n,r,a){u.pgrid.moveField(e,n,r,a),t()},this.filters=null,this.cells=[];var c;this.render=function(e){if(s=e){var t=React.createFactory(l.PivotTable),n=t({pgridwidget:u});c=React.render(n,e)}};var d=l.Dialog.create();this.drilldown=function(e){if(e){var t,n=e.columnDimension.getRowIndexes(),r=e.rowDimension.getRowIndexes().filter(function(e){return n.indexOf(e)>=0}).map(function(e){return u.pgrid.filteredDataSource[e]});t=e.rowType===a.HeaderType.GRAND_TOTAL&&e.colType===a.HeaderType.GRAND_TOTAL?"Grand total":e.rowType===a.HeaderType.GRAND_TOTAL?e.columnDimension.value+"/Grand total ":e.colType===a.HeaderType.GRAND_TOTAL?e.rowDimension.value+"/Grand total ":e.rowDimension.value+"/"+e.columnDimension.value;var i=window.getComputedStyle(c.getDOMNode(),null);d.show({title:t,comp:{type:l.Grid,props:{headers:u.pgrid.config.getDataSourceFieldCaptions(),data:r,theme:u.pgrid.config.theme}},theme:u.pgrid.config.theme,style:{fontFamily:i.getPropertyValue("font-family"),fontSize:i.getPropertyValue("font-size")}})}},t()}},{"./orb.axe":3,"./orb.pgrid":7,"./orb.ui.cols":10,"./orb.ui.header":11,"./orb.ui.rows":13,"./react/orb.react.compiled":15}],13:[function(e,t){var n=e("./orb.axe"),r=e("./orb.ui.header");t.exports=function(e){function t(e,t){if(o)for(var n=e[e.length-1],a=0;l>a;a++)n.push(new r.dataHeader(i.axe.pgrid.config.dataFields[a],t)),l-1>a&&e.push(n=[])}function a(e,i){if(i.values.length>0)for(var o=e.length-1,s=e[o],u=s.length>0?s[s.length-1]:null,c=0;c<i.values.length;c++){var d,p=i.values[c],h=i.subdimvals[p];d=!h.isLeaf&&h.field.subTotal.visible?new r.header(n.Type.ROWS,r.HeaderType.SUB_TOTAL,h,u,l):null;var f=new r.header(n.Type.ROWS,null,h,u,l,d);c>0&&e.push(s=[]),s.push(f),h.isLeaf?t(e,f):(a(e,h),h.field.subTotal.visible&&(e.push([d]),t(e,d)))}}var i=this;this.axe=e,this.uiInfos=[];var o,l;this.build=function(){l="rows"===i.axe.pgrid.config.dataHeadersLocation?i.axe.pgrid.config.dataFieldsCount||1:1,o="rows"===i.axe.pgrid.config.dataHeadersLocation&&l>1;var e=[[]];if(null!=i.axe){if(a(e,i.axe.root),i.axe.pgrid.config.grandTotal.rowsvisible){var s=e[e.length-1],u=new r.header(n.Type.ROWS,r.HeaderType.GRAND_TOTAL,i.axe.root,null,l);0===s.length?s.push(u):e.push([u]),t(e,u)}0===e[0].length&&e[0].push(new r.header(n.Type.ROWS,r.HeaderType.INNER,i.axe.root,null,l))}i.uiInfos=e},this.build()}},{"./orb.axe":3,"./orb.ui.header":11}],14:[function(e,t){t.exports={ns:function(e,t){var n=e.split("."),r=0;for(t=t||window;r<n.length;)t[n[r]]=t[n[r]]||{},t=t[n[r]],r++;return t},ownProperties:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isNumber:function(e){return"[object Number]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},isString:function(e){return"[object String]"===Object.prototype.toString.apply(e)},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.apply(e)},escapeRegex:function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},findInArray:function(e,t){if(this.isArray(e)&&t)for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return r}return void 0},jsonStringify:function(e,t){function n(e,n){return t&&t.indexOf(e)>-1?void 0:n}return JSON.stringify(e,n,2)}}},{}],15:[function(e,t){function n(e,t,n){function r(e,t){return null==t?"none"!=e.parentNode.parentNode.style.display:void(e.parentNode.parentNode.style.display=t?"":"none")}function a(){if(n){var e={values:n.staticValue,toExclude:n.excludeStatic};n.term?(g=!0,v=n.operator,d.select(v.name,!1),h.toggleRegexpButtonVisibility(),n.regexpMode?(m=!0,h.toggleRegexpButtonState(),y=n.term.source):y=n.term,b.searchBox.value=y,h.applyFilterTerm(n.operator,n.term)):c=e,h.updateCheckboxes(e),h.updateAllCheckbox()}}function o(){h.toggleRegexpButtonVisibility(),b.filterContainer.addEventListener("click",h.valueChecked),b.searchBox.addEventListener("keyup",h.searchChanged),b.okButton.addEventListener("click",function(){var t=h.getCheckedValues();e.onFilter(v.name,v.regexpSupported&&g&&m?new RegExp(y,"i"):y,t.values,t.toExclude)}),b.cancelButton.addEventListener("click",function(){e.destroy()})}function l(e,t,n){var r=301,a=223,i={x:0,y:0},o=!1;this.resizeMouseDown=function(e){0===e.button&&(o=!0,document.body.style.cursor="se-resize",i.x=e.pageX,i.y=e.pageY,e.stopPropagation(),e.preventDefault())
},this.resizeMouseUp=function(){return o=!1,document.body.style.cursor="auto",!0},this.resizeMouseMove=function(l){if(o){var s=n.getBoundingClientRect(),u=e.getBoundingClientRect(),c=t.getBoundingClientRect(),d=u.right-u.left,p=u.bottom-u.top,h={x:r>=d&&l.pageX<s.left?0:l.pageX-i.x,y:a>=p&&l.pageY<s.top?0:l.pageY-i.y},f=d+h.x,g=p+h.y;i.x=l.pageX,i.y=l.pageY,f>=r&&(e.style.width=f+"px"),g>=a&&(e.style.height=g+"px",t.style.height=c.bottom-c.top+h.y+"px"),l.stopPropagation(),l.preventDefault()}},n.addEventListener("mousedown",this.resizeMouseDown),document.addEventListener("mouseup",this.resizeMouseUp),document.addEventListener("mousemove",this.resizeMouseMove)}function u(e,t){var n=this,r=e.children[0],a=e.children[1];r.addEventListener("click",function(e){"block"!==a.style.display&&(a.style.display="block",e.preventDefault(),e.stopPropagation())}),a.addEventListener("click",function(e){e.target.parentNode==a&&n.select(e.target.textContent)}),document.addEventListener("click",function(){a.style.display="none"}),this.select=function(e,n){r.textContent!=e&&(r.textContent=e,n!==!1&&t(e))}}var c,d,p,h=this,f="indeterminate",g=!1,m=!1,v=s.Operators.MATCH,y="",b={filterContainer:null,checkboxes:{},searchBox:null,operatorBox:null,allCheckbox:null,addCheckbox:null,enableRegexButton:null,okButton:null,cancelButton:null,resizeGrip:null};this.init=function(){b.filterContainer=t,b.checkboxes={},b.searchBox=b.filterContainer.rows[0].cells[2].children[0],b.operatorBox=b.filterContainer.rows[0].cells[0].children[0],b.okButton=b.filterContainer.rows[2].cells[0].children[0],b.cancelButton=b.filterContainer.rows[2].cells[0].children[1],b.resizeGrip=b.filterContainer.rows[2].cells[1].children[0];for(var e=b.filterContainer.rows[1].cells[0].children[0].rows,n=0;n<e.length;n++){var r=e[n].cells[0].children[0];b.checkboxes[r.value]=r}b.allCheckbox=b.checkboxes[s.ALL],b.addCheckbox=null,b.enableRegexButton=b.filterContainer.rows[0].cells[1],d=new u(b.operatorBox,function(e){v.name!==e&&(v=s.Operators.get(e),h.toggleRegexpButtonVisibility(),h.searchChanged("operatorChanged"))}),p=new l(b.filterContainer.parentNode,b.filterContainer.rows[1].cells[0].children[0],b.resizeGrip),a(),o()},this.toggleRegexpButtonVisibility=function(){v.regexpSupported?(b.enableRegexButton.addEventListener("click",h.regexpActiveChanged),b.enableRegexButton.className=b.enableRegexButton.className.replace(/\s+srchtyp\-col\-hidden/,"")):(b.enableRegexButton.removeEventListener("click",h.regexpActiveChanged),b.enableRegexButton.className+=" srchtyp-col-hidden")},this.toggleRegexpButtonState=function(){b.enableRegexButton.className=b.enableRegexButton.className.replace("srchtyp-col-active",""),m&&(b.enableRegexButton.className+=" srchtyp-col-active")},this.regexpActiveChanged=function(){m=!m,h.toggleRegexpButtonState(),h.searchChanged("regexModeChanged")},this.valueChecked=function(e){var t=e.target;t&&t.type&&"checkbox"===t.type&&(t==b.allCheckbox?h.updateCheckboxes({values:b.allCheckbox.checked}):h.updateAllCheckbox())},this.applyFilterTerm=function(t,n){var a=n?!1:!0,o=t.regexpSupported&&g?m?n:i.escapeRegex(n):n;r(b.allCheckbox,a);for(var l=0;l<e.values.length;l++){var s=e.values[l],u=b.checkboxes[s],c=!g||t.func(s,o);r(u,c),u.checked=c}},this.searchChanged=function(e){var t=(b.searchBox.value||"").trim();if("operatorChanged"===e||"regexModeChanged"===e&&t||t!=y){y=t;var n=g;g=""!==t,g&&!n&&(c=h.getCheckedValues()),("operatorChanged"!==e||g)&&h.applyFilterTerm(v,t),!g&&n&&h.updateCheckboxes(c),h.updateAllCheckbox()}},this.getCheckedValues=function(){if(g||b.allCheckbox.indeterminate){var t,n,a,i,o=0,l=0;for(n=0;n<e.values.length;n++)a=e.values[n],i=b.checkboxes[a],r(i)&&(o++,i.checked&&l++);if(0==l)t=s.NONE;else if(l==o)t=s.ALL;else{t=[];var u=l>o/2+1;for(n=0;n<e.values.length;n++)a=e.values[n],i=b.checkboxes[a],r(i)&&(!u&&i.checked||u&&!i.checked)&&t.push(a)}return{values:t,toExclude:u}}return{values:b.allCheckbox.checked?s.ALL:s.NONE,toExclude:!1}},this.updateCheckboxes=function(t){for(var n=t?t.values:null,a=i.isArray(n)?null:null==n||n===s.ALL?!0:n===s.NONE?!1:!!n,o=0;o<e.values.length;o++){var l=e.values[o],u=b.checkboxes[l];if(r(u))if(null!=a)u.checked=a;else{var c=n.indexOf(l)>=0;u.checked=t.toExclude?!c:c}}},this.updateAllCheckbox=function(){if(!g){for(var t=null,n=0;n<e.values.length;n++){var r=b.checkboxes[e.values[n]];if(null==t)t=r.checked;else if(t!==r.checked){t=f;break}}t===f?(b.allCheckbox.indeterminate=!0,b.allCheckbox.checked=!1):(b.allCheckbox.indeterminate=!1,b.allCheckbox.checked=t)}},this.init()}function r(){var e=document.createElement("div");return e.className="orb-overlay orb-overlay-hidden",document.body.appendChild(e),e}var a="undefined"==typeof window?e("react"):window.React,i=e("../orb.utils"),o=e("../orb.axe"),l=e("../orb.ui.header"),s=e("../orb.filtering"),u=e("./orb.react.utils"),c=1,d=t.exports,p=1;t.exports.PivotTable=a.createClass({id:p++,pgrid:null,pgridwidget:null,getInitialState:function(){return d.DragManager.init(this),this.pgridwidget=this.props.pgridwidget,this.pgrid=this.pgridwidget.pgrid,{}},sort:function(e,t){this.pgridwidget.sort(e,t),this.setProps(this.props)},moveButton:function(e,t,n){this.pgridwidget.moveField(e.props.field.name,e.props.axetype,t,n),this.setProps(this.props)},expandRow:function(e){e.expand(),this.setProps({})},collapseRow:function(e){e.subtotalHeader.collapse(),this.setProps({})},render:function(){var e=this,t=this.pgridwidget.pgrid.config,n=d.PivotButton,r=d.PivotRow,a=d.DropTarget,l=t.availablefields().map(function(t,r){return React.createElement(n,{key:t.name,field:t,axetype:null,position:r,pivotTableComp:e})}),s=t.dataFields.map(function(t,r){return React.createElement(n,{key:t.name,field:t,axetype:o.Type.DATA,position:r,pivotTableComp:e})}),u=t.columnFields.map(function(t,r){return React.createElement(n,{key:t.name,field:t,axetype:o.Type.COLUMNS,position:r,pivotTableComp:e})}),p=i.findInArray(this.pgridwidget.cells,function(e){return"cell-template-fieldbutton"===e[0].template});p=void 0!==p?p.filter(function(e){return"cell-template-fieldbutton"===e.template}).map(function(t,r){return React.createElement(n,{key:t.value.name,field:t.value,axetype:o.Type.ROWS,position:r,pivotTableComp:e})}):[];var h=React.createElement("td",{className:"empty",colSpan:this.pgridwidget.rowHeadersWidth+c,rowSpan:"1"},React.createElement(a,{buttons:p,axetype:o.Type.ROWS})),f=this.pgridwidget.cells.map(function(t,n){return n==e.pgridwidget.columnHeadersHeight-1?React.createElement(r,{key:n,row:t,topmost:0===n,rowButtonsCount:e.pgridwidget.rowHeadersWidth,rowButtonsCell:h,pivotTableComp:e}):React.createElement(r,{key:n,topmost:0===n,row:t,pivotTableComp:e})}),g="bootstrap"===t.theme,m="orb-container orb-"+t.theme,v="orb"+(g?" table":""),y={};return t.width&&(y.width=t.width),t.height&&(y.height=t.height),React.createElement("div",{className:m,style:y},React.createElement("table",{id:"{'tbl' + self.id}",className:v,style:{width:"100%"}},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"flds-grp-cap av-flds text-muted",colSpan:c,rowSpan:"1"},React.createElement("div",null,"Fields")),React.createElement("td",{className:"av-flds",colSpan:this.pgridwidget.totalWidth,rowSpan:"1"},React.createElement(a,{buttons:l,axetype:null}))),React.createElement("tr",null,React.createElement("td",{className:"flds-grp-cap text-muted",colSpan:c,rowSpan:"1"},React.createElement("div",null,"Data")),React.createElement("td",{className:"empty",colSpan:this.pgridwidget.totalWidth,rowSpan:"1"},React.createElement(a,{buttons:s,axetype:o.Type.DATA}))),React.createElement("tr",null,React.createElement("td",{className:"empty",colSpan:this.pgridwidget.rowHeadersWidth+c,rowSpan:"1"}),React.createElement("td",{className:"empty",colSpan:this.pgridwidget.columnHeadersWidth,rowSpan:"1"},React.createElement(a,{buttons:u,axetype:o.Type.COLUMNS}))),f)),React.createElement("div",{className:"orb-overlay orb-overlay-hidden",id:"drilldialog"+e.id}))}}),t.exports.PivotRow=a.createClass({render:function(){var e,t=this,n=d.PivotCell,r=this.props.row.length-1,a=this.props.row[0],i={};return void 0!==this.props.rowButtonsCell?(e=this.props.row.slice(this.props.rowButtonsCount).map(function(e,a){var i=a===r-t.props.rowButtonsCount,o=0===a;return React.createElement(n,{key:a,cell:e,topmost:t.props.topmost,rightmost:i,leftmostheader:o,pivotTableComp:t.props.pivotTableComp})}),React.createElement("tr",null,this.props.rowButtonsCell,e)):("cell-template-row-header"==a.template&&a.visible&&!a.visible()&&(i.display="none"),e=this.props.row.map(function(e,a){var i=a===r,o=0===a&&(e.type===l.HeaderType.EMPTY||e.type===l.HeaderType.SUB_TOTAL&&e.dim.parent.isRoot||e.type===l.HeaderType.GRAND_TOTAL||e.dim&&(e.dim.isRoot||e.dim.parent.isRoot)),s="cell-template-column-header"===e.template&&1===a,u="cell-template-datavalue"===e.template&&e.visible()&&("cell-template-datavalue"!==t.props.row[a-1].template||!t.props.row[a-1].visible());return React.createElement(n,{key:a,cell:e,topmost:t.props.topmost,leftmostheader:s,leftmostdatavalue:u,rightmost:i,leftmost:o,pivotTableComp:t.props.pivotTableComp})}),React.createElement("tr",{style:i},e))}}),t.exports.PivotCell=a.createClass({expand:function(){this.props.pivotTableComp.expandRow(this.props.cell)},collapse:function(){this.props.pivotTableComp.collapseRow(this.props.cell)},render:function(){var e,t,n=this,r=this.props.cell,a=[],i=!1;switch(r.template){case"cell-template-row-header":case"cell-template-column-header":var s=r.type===l.HeaderType.WRAPPER&&r.dim.field.subTotal.visible&&r.dim.field.subTotal.collapsible&&r.subtotalHeader.expanded,u=r.type===l.HeaderType.SUB_TOTAL&&!r.expanded;(s||u)&&(i=!0,a.push(React.createElement("table",{key:"header-value"},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"tgl-btn"},React.createElement("div",{className:"tgl-btn-"+(s?"down":"right"),onClick:s?this.collapse:this.expand})),React.createElement("td",{className:"hdr-val"},React.createElement("div",null,r.value))))))),e=r.value;break;case"cell-template-dataheader":e=r.value.caption;break;case"cell-template-datavalue":e=r.datafield&&r.datafield.formatFunc?r.datafield.formatFunc()(r.value):r.value,t=function(){n.props.pivotTableComp.pgridwidget.drilldown(r,n.props.pivotTableComp.id)}}i||a.push(React.createElement("div",{key:"cell-value",className:"cell-template-datavalue"!==r.template?"hdr-val":""},React.createElement("div",null,e)));var d=r.cssclass,p=!r.visible();return p&&(d+=" cell-hidden"),this.props.topmost&&"cell-template-empty"!==r.template&&(d+=" cell-topmost"),!this.props.rightmost||r.axetype===o.Type.COLUMNS&&r.type!==l.HeaderType.GRAND_TOTAL||(d+=" cell-rightmost"),(this.props.leftmost&&"cell-template-empty"!==r.template||this.props.leftmostheader||this.props.leftmostdatavalue)&&(d+=" cell-leftmost"),("cell-template-column-header"===r.template||"cell-template-dataheader"===r.template)&&(d+=" cntr"),React.createElement("td",{className:d,onDoubleClick:t,colSpan:r.hspan()+(this.props.leftmost?c:0),rowSpan:r.vspan()},React.createElement("div",null,a))}});var h=t.exports.DragManager=function(){function e(e,t){return!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function t(e){return e.onDragOver?(e.onDragOver(o),!0):!1}function n(e){return e.onDragEnd?(e.onDragEnd(),!0):!1}function r(){return u.forEach(s,function(e){return e.component.state.isover?e:void 0},!0)}function a(){return u.forEach(c,function(e){return e.component.state.isover?e:void 0},!0)}var i=null,o=null,l=null,s=[],c=[],d=!1;return{init:function(e){d=!0,i=e},dragElement:function(e){var t=o;if(o=e,o!=t)if(null==e){var d=r(),p=a();if(d){var h=null!=p?p.position:null;i.moveButton(t,d.component.props.axetype,h)}l=null,u.forEach(s,function(e){n(e)}),u.forEach(c,function(e){n(e)})}else l=o.getDOMNode()},registerTarget:function(e,t,n,r){s.push({component:e,axetype:t,onDragOver:n,onDragEnd:r})},unregisterTarget:function(e){for(var t,n=0;n<s.length;n++)if(s[n].component==e){t=n;break}null!=t&&s.splice(t,1)},registerIndicator:function(e,t,n,r,a){c.push({component:e,axetype:t,position:n,onDragOver:r,onDragEnd:a})},unregisterIndicator:function(e){for(var t,n=0;n<c.length;n++)if(c[n].component==e){t=n;break}null!=t&&c.splice(t,1)},elementMoved:function(){if(null!=o){var r,a=l.getBoundingClientRect();u.forEach(s,function(i){if(!r){var o=i.component.getDOMNode().getBoundingClientRect(),l=e(a,o);if(l&&t(i))return r=i,!0;n(i)}},!0);var i;if(r){if(u.forEach(c,function(l){if(!i){var s=l.component.props.axetype===o.props.axetype&&l.component.props.position===o.props.position,u=l.component.props.axetype===r.component.props.axetype;if(u&&!s){var c=l.component.getDOMNode().getBoundingClientRect(),d=e(a,c);if(d&&t(l))return void(i=l)}}n(l)}),!i){var d=c.filter(function(e){return e.component.props.axetype===r.component.props.axetype});d.length>0&&t(d[d.length-1])}}else u.forEach(c,function(e){n(e)})}}}}();t.exports.DropIndicator=a.createClass({displayName:"DropIndicator",getInitialState:function(){return h.registerIndicator(this,this.props.axetype,this.props.position,this.onDragOver,this.onDragEnd),{isover:!1}},componentWillUnmount:function(){h.unregisterIndicator(this)},onDragOver:function(e){this.setState({isover:!0,width:e.getDOMNode().style.width})},onDragEnd:function(){this.setState({isover:!1,width:null})},render:function(){var e="drp-indic";this.props.isFirst&&(e+=" drp-indic-first"),this.props.isLast&&(e+=" drp-indic-last");var t={};return this.state.isover&&(e+=" drp-indic-over"),React.createElement("div",{style:t,className:e})}});var f=0;t.exports.DropTarget=a.createClass({getInitialState:function(){return this.dtid=++f,h.registerTarget(this,this.props.axetype,this.onDragOver,this.onDragEnd),{isover:!1}},componentWillUnmount:function(){h.unregisterTarget(this)},onDragOver:function(){this.setState({isover:!0})},onDragEnd:function(){this.setState({isover:!1})},render:function(){var e=this,n=t.exports.DropIndicator,r=this.props.buttons.map(function(t,r){return r<e.props.buttons.length-1?[React.createElement(n,{isFirst:0===r,position:r,axetype:e.props.axetype}),t]:[React.createElement(n,{isFirst:0===r,position:r,axetype:e.props.axetype}),t,React.createElement(n,{isLast:!0,position:null,axetype:e.props.axetype})]});return React.createElement("div",{className:"drp-trgt"+(this.state.isover?" drp-trgt-over":"")},r)}});var g=0;t.exports.PivotButton=a.createClass({displayName:"PivotButton",getInitialState:function(){return this.pbid=++g,{pos:{x:0,y:0},startpos:{x:0,y:0},mousedown:!1,dragging:!1}},onFilterMouseDown:function(e){if(0===e.button){var t=this.getDOMNode().childNodes[0].rows[0].cells[2].childNodes[0],n=u.getOffset(t),r=document.createElement("div"),a=React.createFactory(d.FilterPanel),i=a({field:this.props.field.name,pivotTableComp:this.props.pivotTableComp});r.className="orb-"+this.props.pivotTableComp.pgrid.config.theme+" orb fltr-cntnr",r.style.top=n.y+"px",r.style.left=n.x+"px",document.body.appendChild(r),React.render(i,r),e.stopPropagation(),e.preventDefault()}},onMouseDown:function(e){if(0===e.button){var t=u.getOffset(this.getDOMNode());this.setState({mousedown:!0,mouseoffset:{x:t.x-e.pageX,y:t.y-e.pageY},startpos:{x:e.pageX,y:e.pageY}}),e.stopPropagation(),e.preventDefault()}},componentDidUpdate:function(){this.state.mousedown?this.state.mousedown&&(h.dragElement(this),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)):(h.dragElement(null),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},componentWillUnmount:function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},onMouseUp:function(){var e=this.state.dragging;return this.setState({mousedown:!1,dragging:!1,size:null,pos:{x:0,y:0}}),e||this.props.pivotTableComp.sort(this.props.axetype,this.props.field),!0},onMouseMove:function(e){if(this.state.mousedown){var t=null;t=this.state.dragging?this.state.size:u.getSize(this.getDOMNode());var n={x:e.pageX+this.state.mouseoffset.x,y:e.pageY+this.state.mouseoffset.y};this.setState({dragging:!0,size:t,pos:n}),h.elementMoved(),e.stopPropagation(),e.preventDefault()}},render:function(){var e=this,t={left:e.state.pos.x+"px",top:e.state.pos.y+"px",position:e.state.dragging?"fixed":""};e.state.size&&(t.width=e.state.size.width+"px");var n="asc"===e.props.field.sort.order?" \u2191":"desc"===e.props.field.sort.order?" \u2193":"",r=(e.state.dragging?"":"fltr-btn")+(this.props.pivotTableComp.pgrid.isFieldFiltered(this.props.field.name)?" fltr-btn-active":"");return React.createElement("div",{key:e.props.field.name,className:"fld-btn"+("bootstrap"===this.props.pivotTableComp.pgrid.config.theme?" btn btn-default":""),onMouseDown:this.onMouseDown,style:t},React.createElement("table",null,React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{style:{padding:0}},e.props.field.caption),React.createElement("td",{style:{padding:0,width:13}},n),React.createElement("td",{style:{padding:0,verticalAlign:"top"}},React.createElement("div",{className:r,onMouseDown:e.state.dragging?null:this.onFilterMouseDown}))))))}}),t.exports.FilterPanel=a.createClass({pgridwidget:null,values:null,getInitialState:function(){return this.pgridwidget=this.props.pivotTableComp.pgridwidget,{}},destroy:function(){var e=this.getDOMNode().parentNode;React.unmountComponentAtNode(e),e.parentNode.removeChild(e)},onFilter:function(e,t,n,r){this.pgridwidget.applyFilter(this.props.field,e,t,n,r),this.destroy()},onMouseDown:function(e){for(var t=this.getDOMNode().parentNode,n=e.target;null!=n;){if(n==t)return!0;n=n.parentNode}this.destroy()},onMouseWheel:function(e){for(var t=this.getDOMNode().rows[1].cells[0].children[0],n=e.target;null!=n;){if(n==t)return void(t.scrollHeight<=t.clientHeight&&(e.stopPropagation(),e.preventDefault()));n=n.parentNode}this.destroy()},componentWillMount:function(){document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("wheel",this.onMouseWheel),window.addEventListener("resize",this.destroy)},componentDidMount:function(){new n(this,this.getDOMNode(),this.pgridwidget.pgrid.getFieldFilter(this.props.field))},componentWillUnmount:function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("resize",this.destroy)},render:function(){function e(e,n){return t.push(React.createElement("tr",{key:e},React.createElement("td",{className:"fltr-chkbox"},React.createElement("input",{type:"checkbox",value:e,defaultChecked:"checked"})),React.createElement("td",{className:"fltr-val",title:n||e},n||e)))}var t=[];this.values=this.pgridwidget.pgrid.getFieldValues(this.props.field),e(s.ALL,"(Show All)"),this.values.containsBlank&&e(s.BLANK,"(Blank)");for(var n=0;n<this.values.length;n++)e(this.values[n]);var r="orb-btn"+(this.props.pivotTableComp.pgrid.config.bootstrap?" btn btn-default btn-xs":""),a=window.getComputedStyle(this.props.pivotTableComp.getDOMNode(),null),i={fontFamily:a.getPropertyValue("font-family"),fontSize:a.getPropertyValue("font-size")};return React.createElement("table",{className:"fltr-scntnr",style:i},React.createElement("tbody",null,React.createElement("tr",null,React.createElement("td",{className:"srchop-col"},React.createElement("div",{className:"orb-select"},React.createElement("div",null,s.Operators.MATCH.name),React.createElement("ul",null,React.createElement("li",null,s.Operators.MATCH.name),React.createElement("li",null,s.Operators.NOTMATCH.name),React.createElement("li",null,s.Operators.EQ.name),React.createElement("li",null,s.Operators.NEQ.name),React.createElement("li",null,s.Operators.GT.name),React.createElement("li",null,s.Operators.GTE.name),React.createElement("li",null,s.Operators.LT.name),React.createElement("li",null,s.Operators.LTE.name)))),React.createElement("td",{className:"srchtyp-col",title:"Enable/disable Regular expressions"},".*"),React.createElement("td",{className:"srchbox-col"},React.createElement("input",{type:"text",placeholder:"search"}))),React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"fltr-vals-col"},React.createElement("table",{className:"fltr-vals-tbl"},React.createElement("tbody",null,t)))),React.createElement("tr",{className:"bottom-row"},React.createElement("td",{className:"cnfrm-btn-col",colSpan:"2"},React.createElement("input",{type:"button",className:r,value:"Ok",style:{"float":"left"}}),React.createElement("input",{type:"button",className:r,value:"Cancel",style:{"float":"left"}})),React.createElement("td",{className:"resize-col"},React.createElement("div",null)))))}}),t.exports.Grid=a.createClass({render:function(){var e=this.props.data,t=this.props.headers,n="bootstrap"==this.props.theme?"table table-striped table-condensed":"orb-table",r=[];if(t&&t.length>0){for(var a=[],i=0;i<t.length;i++)a.push(React.createElement("th",{key:"h"+i},t[i]));r.push(React.createElement("tr",{key:"h"},a))}if(e&&e.length>0)for(var o=0;o<e.length;o++){for(var l=[],s=0;s<e[o].length;s++)l.push(React.createElement("td",{key:o+""+s},e[o][s]));r.push(React.createElement("tr",{key:o},l))}return React.createElement("table",{className:n},React.createElement("tbody",null,r))}});var m=t.exports.Dialog=a.createClass({statics:{create:function(){var e=React.createFactory(m),t=r();return{show:function(n){React.render(e(n),t)}}}},overlayElement:null,setOverlayClass:function(e){this.overlayElement.className="orb-overlay orb-overlay-"+(e?"visible":"hidden")+" orb-"+this.props.theme+("bootstrap"===this.props.theme?" modal":"")},componentDidMount:function(){this.overlayElement=this.getDOMNode().parentNode,this.setOverlayClass(!0),this.overlayElement.addEventListener("click",this.close);var e=this.overlayElement.children[0],t=e.children[0].children[1],n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),r=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=2*r/3;a=301>a?301:a;var i=e.offsetWidth+(e.offsetHeight>a?11:0),o=e.offsetHeight>a?a:e.offsetHeight;e.style.top=(r>o?(r-o)/2:0)+"px",e.style.left=(n>i?(n-i)/2:0)+"px",e.style.height=o+"px",t.style.width=i+"px",t.style.height=o-45+"px"},close:function(e){(e.target==this.overlayElement||"button-close"===e.target.className)&&(this.overlayElement.removeEventListener("click",this.close),React.unmountComponentAtNode(this.overlayElement),this.setOverlayClass(!1))},render:function(){if(this.props.comp){var e=React.createElement(this.props.comp.type,this.props.comp.props),t="bootstrap"===this.props.theme,n="orb-dialog"+(t?" modal-dialog":""),r=t?"modal-content":"",a="orb-dialog-header"+(t?" modal-header":""),i=t?"modal-title":"",o="orb-dialog-body"+(t?" modal-body":"");return React.createElement("div",{className:n,style:this.props.style||{}},React.createElement("div",{className:r},React.createElement("div",{className:a},React.createElement("div",{className:"button-close",onClick:this.close}),React.createElement("div",{className:i},this.props.title)),React.createElement("div",{className:o},e)))}}})},{"../orb.axe":3,"../orb.filtering":6,"../orb.ui.header":11,"../orb.utils":14,"./orb.react.utils":16,react:void 0}],16:[function(e,t){t.exports.forEach=function(e,t,n){var r;if(null!=e)for(var a=0,i=e.length;i>a&&(r=t(e[a],a),void 0===r||n!==!0);a++);return r},t.exports.getOffset=function(e){if(null!=e){var t=e.getBoundingClientRect();return{x:t.left+0,y:t.top+0}}return{x:0,y:0}},t.exports.getSize=function(e){if(null!=e){var t=e.getBoundingClientRect();return{width:t.right-t.left,height:t.bottom-t.top}}return{x:0,y:0}}},{}]},{},[1])(1)});

//# sourceMappingURL=orb-1.0.7.min.js.map