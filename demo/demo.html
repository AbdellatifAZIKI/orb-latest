<!DOCTYPE html>
<html>
<head>
	<title></title>
	<!--<link rel="stylesheet/less" type="text/css" href="../src/css/orb.css" />
	<script type="text/javascript" src="../lib/less.js"></script>-->
	<link rel="stylesheet" type="text/css" href="../dist/orb.min.css" />

	<!--<script type="text/javascript" src="../lib/react-0.11.2.js"></script>-->
	<script type="text/javascript" src="../lib/react.min.js"></script>
	<script type="text/javascript" src="../dist/orb.debug.js"></script>
	
	<!--
	<script type="text/javascript" src="../lib/JSXTransformer-0.11.2.js"></script>
	
	<script type="text/javascript" src="../src/js/orb.js"></script>
	<script type="text/javascript" src="../src/js/orb.dimension.js"></script>
	<script type="text/javascript" src="../src/js/orb.axe.js"></script>
	<script type="text/javascript" src="../src/js/orb.ui.header.js"></script>
	<script type="text/javascript" src="../src/js/orb.ui.cols.js"></script>
	<script type="text/javascript" src="../src/js/orb.ui.rows.js"></script>
	<script type="text/javascript" src="../src/js/orb.config.js"></script>
	<script type="text/javascript" src="../src/js/orb.pgrid.js"></script>
	<script type="text/javascript" src="../src/js/orb.ui.pgridwidget.js"></script>

	<script type="text/jsx" src="../src/js/react/orb.react.components.js"></script>
	<script type="text/jsx" src="../src/js/react/orb.react.dragndrop.js"></script>-->
	<!--<script type="text/javascript" src="../src/js/react/orb.react.compiled.js"></script>-->
	<script type="text/javascript" src="demo.data.js"></script>
</head>
<body>

	<div id="rr"></div>

	<script type="text/javascript">

		var config = {
			datasource: orb.demo.data,
			showgrandtotal: true,
			subtotal: {
				visible: false,
			},
			fields: [
				{ 
					name: 'voter',
					caption: 'Voter', 
					sort: {
						order: '',
						customfunc: function(a, b) {
							return a > b ? 1 : (a < b ? -1 : 0);
						}
					},
					filter: null,
					subtotal: { 
						visible: true,
						collapsible: true,
						collapsed: false
					},
					columnsettings: {

					},
					datasettings: {
						aggregatefunc: function(dataField, intersection, datasource, rowIndexes, colIndexes) {
							var ilen = (intersection || datasource).length;
							var rlen = (rowIndexes || datasource).length;
							return rlen > 0 ? (ilen*100/rlen).toFixed(1)+'%' : '';
						  }
					}
				},
				{ name: 'party', caption: 'Party', 
					rowsettings: {
						subtotal: { 
							visible: false
						}
					}
				},
				{ name: 'precinct', caption: 'Precinct'},
				{ name: 'ageGroup', caption: 'Age group',
					sort: {
						order: 'asc'
					},
					subtotal: { 
						collapsed: true
					}
				},
				{ name: 'lastVoted', caption: 'Last voted'},
				{ name: 'yearsReg', caption: 'Years Reg' },
				{ name: 'ballotStatus', caption: 'Ballot status' }
			],
			rows: [
				{ name: 'party' }
			],
			columns: [
				{ name: 'lastVoted', subtotal: { visible: false} },
				{ name: 'ageGroup', subtotal: { visible: false} },
				{ name: 'ballotStatus' }
			],
			data: [
				{ name: 'voter',
				  filter: null,
				  aggregatefunc: function(dataField, intersection, datasource, rowIndexes, colIndexes) {
					var ilen = (intersection || datasource).length;
					var rlen = (rowIndexes || datasource).length;
					return rlen > 0 ? (ilen*100/rlen).toFixed(1)+'%' : '';
				  }
				}
			]
		};

		var elem = document.getElementById('rr')

		setTimeout(function() {
			var pg = new orb.pgrid(config);
			var pgw = new orb.ui.pgridwidget(pg);		

			var comp = orb.react.PivotTable({
				  	data: pgw
				  });

			React.renderComponent(comp, elem);		
		}, 1000);

	</script>
</body>
</html>